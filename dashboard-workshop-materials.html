<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="AMMnet Senegal Workshop">

<title>Hands-On Shiny: Routine Malaria Data Dashboard Workshop ‚Äì Data Dashboard Training Materials</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b91c67fa4b5af78359063df39734c13f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Data Dashboard Training Materials</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-materials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Materials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-materials">    
        <li>
    <a class="dropdown-item" href="./english-slides.html">
 <span class="dropdown-text">Part 1 Slides (EN)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./french-slides.html">
 <span class="dropdown-text">Part 1 Slides (FR)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dashboarding-slides.html">
 <span class="dropdown-text">Part 2 Slides</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dashboard-workshop-materials.html">
 <span class="dropdown-text">Part 2 Worksheet</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./hand-out.html">
 <span class="dropdown-text">Part 2 Reference sheet</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a>
  <ul>
  <li><a href="#install-packages" id="toc-install-packages" class="nav-link" data-scroll-target="#install-packages">Install Packages</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#set-up-app-skeleton" id="toc-set-up-app-skeleton" class="nav-link" data-scroll-target="#set-up-app-skeleton">Set up App Skeleton</a></li>
  <li><a href="#anatomy-of-a-shiny-app" id="toc-anatomy-of-a-shiny-app" class="nav-link" data-scroll-target="#anatomy-of-a-shiny-app">Anatomy of a Shiny App</a></li>
  <li><a href="#read-in-our-data" id="toc-read-in-our-data" class="nav-link" data-scroll-target="#read-in-our-data">Read In Our Data</a></li>
  </ul></li>
  <li><a href="#part-1-shiny-building-blocks" id="toc-part-1-shiny-building-blocks" class="nav-link" data-scroll-target="#part-1-shiny-building-blocks">Part 1: Shiny Building Blocks</a>
  <ul>
  <li><a href="#setting-up-an-empty-layout" id="toc-setting-up-an-empty-layout" class="nav-link" data-scroll-target="#setting-up-an-empty-layout">Setting up an Empty Layout</a></li>
  <li><a href="#layout-elements" id="toc-layout-elements" class="nav-link" data-scroll-target="#layout-elements">Layout Elements</a>
  <ul>
  <li><a href="#cards" id="toc-cards" class="nav-link" data-scroll-target="#cards"><code>Cards()</code></a></li>
  <li><a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1">Exercise 1</a></li>
  <li><a href="#value_boxes" id="toc-value_boxes" class="nav-link" data-scroll-target="#value_boxes"><code>value_boxes()</code></a></li>
  <li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2">Exercise 2</a></li>
  </ul></li>
  <li><a href="#adjusting-layout-positions" id="toc-adjusting-layout-positions" class="nav-link" data-scroll-target="#adjusting-layout-positions">Adjusting Layout Positions</a>
  <ul>
  <li><a href="#layout_columns" id="toc-layout_columns" class="nav-link" data-scroll-target="#layout_columns"><code>layout_columns()</code></a></li>
  <li><a href="#exercise-3" id="toc-exercise-3" class="nav-link" data-scroll-target="#exercise-3">Exercise 3</a></li>
  <li><a href="#layout_column_wrap" id="toc-layout_column_wrap" class="nav-link" data-scroll-target="#layout_column_wrap"><code>layout_column_wrap()</code></a></li>
  </ul></li>
  <li><a href="#widget-control-elements" id="toc-widget-control-elements" class="nav-link" data-scroll-target="#widget-control-elements">Widget Control Elements</a>
  <ul>
  <li><a href="#choosing-the-right-input-controls-a-quick-exploration" id="toc-choosing-the-right-input-controls-a-quick-exploration" class="nav-link" data-scroll-target="#choosing-the-right-input-controls-a-quick-exploration">Choosing the Right Input controls: A Quick Exploration</a></li>
  <li><a href="#exercise-4" id="toc-exercise-4" class="nav-link" data-scroll-target="#exercise-4">Exercise 4</a></li>
  </ul></li>
  <li><a href="#putting-it-all-together" id="toc-putting-it-all-together" class="nav-link" data-scroll-target="#putting-it-all-together">Putting it all together</a></li>
  <li><a href="#pause-reflect-where-we-are" id="toc-pause-reflect-where-we-are" class="nav-link" data-scroll-target="#pause-reflect-where-we-are">Pause &amp; Reflect: Where We Are</a>
  <ul>
  <li><a href="#quick-self-check-questions" id="toc-quick-self-check-questions" class="nav-link" data-scroll-target="#quick-self-check-questions">Quick self-check questions</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-2-reactivty-and-rendering-output" id="toc-part-2-reactivty-and-rendering-output" class="nav-link" data-scroll-target="#part-2-reactivty-and-rendering-output">Part 2 Reactivty and Rendering output</a>
  <ul>
  <li><a href="#shiny-output-types" id="toc-shiny-output-types" class="nav-link" data-scroll-target="#shiny-output-types">Shiny Output Types</a></li>
  <li><a href="#building-reactive-outputs-ui-and-server-crosstalk" id="toc-building-reactive-outputs-ui-and-server-crosstalk" class="nav-link" data-scroll-target="#building-reactive-outputs-ui-and-server-crosstalk">Building Reactive Outputs: <code>ui</code> and <code>server</code> crosstalk</a></li>
  <li><a href="#reactivity-and-data" id="toc-reactivity-and-data" class="nav-link" data-scroll-target="#reactivity-and-data">Reactivity and Data</a>
  <ul>
  <li><a href="#exercise-5" id="toc-exercise-5" class="nav-link" data-scroll-target="#exercise-5">Exercise 5</a></li>
  </ul></li>
  <li><a href="#adding-a-reactive-plot" id="toc-adding-a-reactive-plot" class="nav-link" data-scroll-target="#adding-a-reactive-plot">Adding a Reactive Plot</a>
  <ul>
  <li><a href="#exercise-6--7" id="toc-exercise-6--7" class="nav-link" data-scroll-target="#exercise-6--7">Exercise 6 -7:</a></li>
  </ul></li>
  <li><a href="#end-of-part-2-what-youve-built-so-far" id="toc-end-of-part-2-what-youve-built-so-far" class="nav-link" data-scroll-target="#end-of-part-2-what-youve-built-so-far">End of Part 2 ‚Äî What You‚Äôve Built So Far</a></li>
  </ul></li>
  <li><a href="#part-3-evolving-features---making-our-app-better" id="toc-part-3-evolving-features---making-our-app-better" class="nav-link" data-scroll-target="#part-3-evolving-features---making-our-app-better">Part 3: Evolving Features - Making Our App Better!</a>
  <ul>
  <li><a href="#adding-messages-and-prompts" id="toc-adding-messages-and-prompts" class="nav-link" data-scroll-target="#adding-messages-and-prompts">Adding messages and prompts üìß</a></li>
  <li><a href="#adding-a-short-description-of-the-application" id="toc-adding-a-short-description-of-the-application" class="nav-link" data-scroll-target="#adding-a-short-description-of-the-application">Adding a Short Description of the Application üñäÔ∏è</a>
  <ul>
  <li><a href="#exercise-8" id="toc-exercise-8" class="nav-link" data-scroll-target="#exercise-8">Exercise 8</a></li>
  </ul></li>
  <li><a href="#theming-with-bs_theme" id="toc-theming-with-bs_theme" class="nav-link" data-scroll-target="#theming-with-bs_theme">Theming with <code>bs_theme</code> üé®</a>
  <ul>
  <li><a href="#exercise-9" id="toc-exercise-9" class="nav-link" data-scroll-target="#exercise-9">Exercise 9</a></li>
  <li><a href="#exercise-10" id="toc-exercise-10" class="nav-link" data-scroll-target="#exercise-10">Exercise 10</a></li>
  </ul></li>
  <li><a href="#adding-a-logo-to-your-app" id="toc-adding-a-logo-to-your-app" class="nav-link" data-scroll-target="#adding-a-logo-to-your-app">Adding a Logo to Your App</a>
  <ul>
  <li><a href="#exercise-11" id="toc-exercise-11" class="nav-link" data-scroll-target="#exercise-11">Exercise 11</a></li>
  </ul></li>
  <li><a href="#wrapping-up-part-3-building-for-the-user" id="toc-wrapping-up-part-3-building-for-the-user" class="nav-link" data-scroll-target="#wrapping-up-part-3-building-for-the-user">Wrapping up Part 3 ‚Äî Building for the User</a></li>
  </ul></li>
  <li><a href="#part-4-addiditional-outputs" id="toc-part-4-addiditional-outputs" class="nav-link" data-scroll-target="#part-4-addiditional-outputs">Part 4: Addiditional Outputs</a>
  <ul>
  <li><a href="#computed-variables-and-conditional-widgets" id="toc-computed-variables-and-conditional-widgets" class="nav-link" data-scroll-target="#computed-variables-and-conditional-widgets">Computed Variables and Conditional Widgets</a>
  <ul>
  <li><a href="#exrecise-12" id="toc-exrecise-12" class="nav-link" data-scroll-target="#exrecise-12">Exrecise 12</a></li>
  </ul></li>
  <li><a href="#input-selection-within-cards" id="toc-input-selection-within-cards" class="nav-link" data-scroll-target="#input-selection-within-cards">Input Selection Within Cards</a>
  <ul>
  <li><a href="#stretch-exercise" id="toc-stretch-exercise" class="nav-link" data-scroll-target="#stretch-exercise">Stretch Exercise</a></li>
  </ul></li>
  <li><a href="#including-leaflet-maps" id="toc-including-leaflet-maps" class="nav-link" data-scroll-target="#including-leaflet-maps">Including Leaflet Maps</a>
  <ul>
  <li><a href="#exercise-13" id="toc-exercise-13" class="nav-link" data-scroll-target="#exercise-13">Exercise 13</a></li>
  </ul></li>
  <li><a href="#adding-a-table-output" id="toc-adding-a-table-output" class="nav-link" data-scroll-target="#adding-a-table-output">Adding a Table Output</a>
  <ul>
  <li><a href="#exercise-14---tricky" id="toc-exercise-14---tricky" class="nav-link" data-scroll-target="#exercise-14---tricky">Exercise 14 - Tricky</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#wrapping-up" id="toc-wrapping-up" class="nav-link" data-scroll-target="#wrapping-up">Wrapping Up</a></li>
  <li><a href="#next-steps-and-extensions" id="toc-next-steps-and-extensions" class="nav-link" data-scroll-target="#next-steps-and-extensions">Next Steps and Extensions</a>
  <ul>
  <li><a href="#expanding-functionality" id="toc-expanding-functionality" class="nav-link" data-scroll-target="#expanding-functionality">Expanding Functionality</a></li>
  <li><a href="#organizing-and-scaling-your-code" id="toc-organizing-and-scaling-your-code" class="nav-link" data-scroll-target="#organizing-and-scaling-your-code">Organizing and Scaling Your Code</a></li>
  <li><a href="#deployment-and-sharing" id="toc-deployment-and-sharing" class="nav-link" data-scroll-target="#deployment-and-sharing">Deployment and Sharing</a></li>
  <li><a href="#styling-and-user-experience" id="toc-styling-and-user-experience" class="nav-link" data-scroll-target="#styling-and-user-experience">Styling and User Experience</a></li>
  <li><a href="#useful-resources-for-further-learning" id="toc-useful-resources-for-further-learning" class="nav-link" data-scroll-target="#useful-resources-for-further-learning">Useful Resources for Further Learning</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hands-On Shiny: Routine Malaria Data Dashboard Workshop</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>AMMnet Senegal Workshop </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level1">
<h1>Setup</h1>
<p>Welcome to the ‚Äú<em>Developing Data Visualisation Dashboards in R</em>‚Äù workshop! In this session, we‚Äôll build a Shiny app step by step, exploring what Shiny can do - from basic reactive plots to interactive tables, maps, and advanced UI elements. Each section includes explanatory text, demo code, and exercises for you to try.</p>
<blockquote class="blockquote">
<p><strong>Why RShiny?</strong></p>
<ul>
<li><p>Shiny lets you turn R code into interactive web applications without needing to learn HTML/CSS/JS.</p></li>
<li><p>In malaria programs, routine data (e.g., DHIS2 exports) are key to monitoring. A Shiny dashboard can help stakeholders explore data visually, spot trends, and inform decisions and perform routine analysis.</p></li>
<li><p>We‚Äôll continue using our DHIS2 dataset that we just downloaded and cleaned.</p></li>
</ul>
</blockquote>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Before you begin:</strong></p>
<ul>
<li><p>Ensure you have your <strong>R Studio Project</strong> open.</p></li>
<li><p>Ensure you have your DHIS2 cleaned data saved into the correct folder: <code>data-outputs/data_dhis2_laos_ammnet_cleaned.csv</code></p></li>
<li><p>If you didn‚Äôt finish the steps in the earlier session - we have the dataset avaliable for download on the home page.</p></li>
</ul>
</div>
</div>
<section id="install-packages" class="level2">
<h2 class="anchored" data-anchor-id="install-packages">Install Packages</h2>
<p>We need some addiditional packages for this session - install these packages if you don‚Äôt have them already using the code below in the console:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"shiny"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"bslib"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"DT"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"plotly"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"leaflet"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"sf"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"lubridate"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"bsicons"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These packages will allow us to do the following:</p>
<ul>
<li><p><strong><code>shiny</code></strong>: core package to build apps.</p></li>
<li><p><strong><code>bslib</code></strong>: theming (Bootstrap customization) and modern dashboard design elements.</p></li>
<li><p><strong><code>tidyverse</code></strong>: data wrangling (dplyr, ggplot2, readr‚Ä¶).</p></li>
<li><p><strong><code>DT</code></strong>: interactive tables.</p></li>
<li><p><strong><code>plotly</code></strong>: interactive plots.</p></li>
<li><p><strong><code>leaflet</code></strong> &amp; <strong><code>sf</code></strong>: mapping spatial data.</p></li>
<li><p><strong><code>lubridate</code></strong>: for dealting with date-time.</p></li>
<li><p><strong><code>bsicons</code></strong>: for using Bootstrap icons in Shiny.</p></li>
</ul>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<p>Imagine you are a data analyst for the Minstry of Health and you‚Äôve been tasked with creating a way for Provinces in the country to quickly and easily visualise and compare their malaria trends without the need for individual excel files or analyses. That‚Äôs the kind of problem we‚Äôre framing our dashboard around today. During this session you will:</p>
<ul>
<li><p>Understand key elements of Shiny Dashbaords</p></li>
<li><p>Gain hands on experience customising Shiny dashbaords</p></li>
</ul>
<p>We can‚Äôt cover all aspects of creating Shiny Dashboards but there are a tonne of great resources online we will share during the course of today!</p>
<p>We‚Äôll start by highlighting some key building blocks of dashbboards before moving into customisations and visualisation rendering.</p>
<p>In the end we hope you will have created something like the dashboard as shown below:</p>
<p><img src="images/final-final.PNG" class="img-fluid"></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Tips for this tutorial</p>
<ul>
<li><p>After each step of the tutorial ensure you press <strong>Run App or Refresh App</strong> to visualise your changes</p></li>
<li><p>Sometimes cleaning the environment or restartng R can be helpful when if your app isn‚Äôt updating with changes.</p></li>
<li><p>To check the definition, usage and arguements of functions type ? followed by the funcition name in the Console e.g.&nbsp;<code>?value_box</code>.</p></li>
<li><p>When designing a Shiny App - always think about the end user and their journey through the application.</p></li>
</ul>
</div>
</div>
</section>
<section id="set-up-app-skeleton" class="level2">
<h2 class="anchored" data-anchor-id="set-up-app-skeleton">Set up App Skeleton</h2>
<p>Now we have Shiny installed we can create our first App. Open up a new R script and save it as <code>app.R</code> in your main project folder.</p>
<p>Copy the code below which is a demo app the is built into the <code>Shiny</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a Shiny web application. You can run the application by clicking</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the 'Run App' button above.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out more about building applications with Shiny here:</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#    https://shiny.posit.co/</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define UI for application that draws a histogram</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Application title</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">titlePanel</span>(<span class="st">"Old Faithful Geyser Data"</span>),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sidebar with a slider input for number of bins </span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarLayout</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sidebarPanel</span>(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sliderInput</span>(<span class="st">"bins"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Number of bins:"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">min =</span> <span class="dv">1</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">max =</span> <span class="dv">50</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">value =</span> <span class="dv">30</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Show a plot of the generated distribution</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mainPanel</span>(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>           <span class="fu">plotOutput</span>(<span class="st">"distPlot"</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Define server logic required to draw a histogram</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>distPlot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># generate bins based on input$bins from ui.R</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        x    <span class="ot">&lt;-</span> faithful[, <span class="dv">2</span>]</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        bins <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length.out =</span> input<span class="sc">$</span>bins <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># draw the histogram with the specified number of bins</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>        <span class="fu">hist</span>(x, <span class="at">breaks =</span> bins, <span class="at">col =</span> <span class="st">'darkgray'</span>, <span class="at">border =</span> <span class="st">'white'</span>,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab =</span> <span class="st">'Waiting time to next eruption (in mins)'</span>,</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">'Histogram of waiting times'</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the application </span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is a simple pre-built demo that generates an app with a slider <code>sliderInput</code> to determine the number of bins on the corresponding histogram plot. You can see with just a few lines of code how easy it is to generate an interactive application!</p>
<ul>
<li><p>When you run this with <strong>Run App</strong> in RStudio, Shiny launches a local web app .</p></li>
<li><p><strong>Reactivity</strong>: When an input changes, reactive code re-executes and updates outputs automatically.</p></li>
</ul>
<p>Lets close this app and go ahead and build own now!</p>
</section>
<section id="anatomy-of-a-shiny-app" class="level2">
<h2 class="anchored" data-anchor-id="anatomy-of-a-shiny-app">Anatomy of a Shiny App</h2>
<p>Before jumping into code, a quick reminder of the basic app structure.</p>
<p>A <strong>Shiny app</strong> has two key components:</p>
<ol type="1">
<li><p><strong><code>UI</code></strong> (User Interface): defines what users see and interact with: inputs (dropdowns, sliders) and outputs (plots, tables, text). It controls the layout and appearance of your app.</p></li>
<li><p><strong><code>Server</code></strong>: R code that reacts to user inputs, does computations, and sends rendered outputs to the UI. It contains the instructions that your computer needs to build your app</p></li>
<li><p>Finally the&nbsp;<code>shinyApp</code>&nbsp;function creates Shiny app objects from an explicit UI/server pair.</p></li>
</ol>
<p>Lets remove the contents of the <strong>UI</strong> and <strong>Server</strong> code from the default application to give something like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a Shiny web application. You can run the application by clicking</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the 'Run App' button above.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out more about building applications with Shiny here:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#    https://shiny.posit.co/</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#-Define UI for application - User Interface------------------------------------</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#-Define server logic - Computations-------------------------------------------- </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reactive expressions, computations and render functions</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#-Run the application-----------------------------------------------------------</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now add in our addiditional library calls that we had installed and will need for this application at the top of the script - <strong>Ensure this is written outside of the <code>ui</code> and <code>server</code> functions</strong>. This will ensure that these packages are loaded when the app starts up.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-packages needed---------------------------------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bslib)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bsicons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-in-our-data" class="level2">
<h2 class="anchored" data-anchor-id="read-in-our-data">Read In Our Data</h2>
<p>Next we need to ensure we read in the correct data to be able to start creating and generating outputs.</p>
<p>Add the following code after the <code>library</code> calls and before the <code>UI</code> code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-read in app data once on app start up-----------------------------------------</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>app_data <span class="ot">&lt;-</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.csv</span>(<span class="st">"./data-outputs/data_dhis2_laos_ammnet_cleaned.csv"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     organisation_unit     period               var_name  value
1 01 Vientiane Capital 2024-01-01          malaria_tests 102.00
2 01 Vientiane Capital 2024-01-01 malaria_cases_per_1000   1.26
3 01 Vientiane Capital 2024-01-01          malaria_cases  11.00
4 01 Vientiane Capital 2024-02-01          malaria_tests 109.00
5 01 Vientiane Capital 2024-02-01 malaria_cases_per_1000   1.58
6 01 Vientiane Capital 2024-02-01          malaria_cases  12.00</code></pre>
</div>
</div>
<p>You might notice that the <code>period</code> colum has been read in as a <code>character</code> variable so we need to ensure that this is in <code>date</code> format.</p>
<p>Add the following line of code after you read in the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># re-classify period as a date </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>app_data<span class="sc">$</span>period <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">as_date</span>(app_data<span class="sc">$</span>period)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we have our data ready to use in the app, we can start building out the UI and Server components.</p>
</section>
</section>
<section id="part-1-shiny-building-blocks" class="level1">
<h1>Part 1: Shiny Building Blocks</h1>
<section id="setting-up-an-empty-layout" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-an-empty-layout">Setting up an Empty Layout</h2>
<p>For this tutorial we will focus on building our Shiny app using <a href="https://rstudio.github.io/bslib/index.html"><code>bslib</code></a>, a modern UI toolkit that gives your app a clean and responsive layout with minimal effort.</p>
<p>We‚Äôll begin by setting up a basic dashboard skeleton - no data or inputs yet - just the layout structure using <code>bslib::page_sidebar()</code>.</p>
<p>This gives us a two-pane layout:</p>
<ul>
<li><p>A sidebar (on the left) for inputs or filters</p></li>
<li><p>A main content area (on the right) for plots, tables, or summaries</p></li>
</ul>
<p>Paste the following code into your <code>app.R</code> file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-Load libraries----------------------------------------------------------------</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bslib)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#-read in app data once on app start up-----------------------------------------</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>app_data <span class="ot">&lt;-</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.csv</span>(<span class="st">"./data-outputs/data_dhis2_laos_ammnet_cleaned.csv"</span>) </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># re-classify period as a date </span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>app_data<span class="sc">$</span>period <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">as_date</span>(app_data<span class="sc">$</span>period)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#-Define UI for application - User Interface------------------------------------</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_sidebar</span>(</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"My Dashboard"</span>,  <span class="co"># Title shown in the top bar</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">sidebar =</span> <span class="st">"Sidebar"</span>,     <span class="co"># Placeholder sidebar content</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Main content area"</span>     <span class="co"># Placeholder for main content (e.g., plots or tables)</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">#-Define server logic - Computations-------------------------------------------- </span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Placeholder for reactive expressions and outputs</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co">#-Run the application-----------------------------------------------------------</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>What This Does</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Component</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>page_sidebar()</code></td>
<td>Creates a full-page layout with a sidebar + main area</td>
</tr>
<tr class="even">
<td><code>title = "..."</code></td>
<td>Sets the page title shown in the app‚Äôs header bar</td>
</tr>
<tr class="odd">
<td><code>sidebar = "..."</code></td>
<td>Placeholder content for the sidebar (we‚Äôll replace this with inputs soon)</td>
</tr>
<tr class="even">
<td><code>"Main content area"</code></td>
<td>Text shown in the main panel (this will later become plots and tables)</td>
</tr>
</tbody>
</table>
<p>Click <strong>Run App</strong> in RStudio. You‚Äôll see:</p>
<ul>
<li><p>A header bar with the title</p></li>
<li><p>A left-hand sidebar with the word <em>Sidebar</em></p></li>
<li><p>A main panel with the text <em>Main content area</em></p></li>
</ul>
<p>üéâ That‚Äôs your first <code>bslib</code> layout up and running!</p>
<p><img src="images/step1-empty.PNG" class="img-fluid"></p>
<p>You can add additional elements to the main panel of the page by supplying them to <code>page_sidebar</code>.</p>
<p>By default, the sidebar panel will appear on the left side of your app. You can move it to the right side by giving <code>sidebar</code> the optional argument <code>position = "right"</code>.</p>
<p>üíª <strong>Try this now</strong></p>
<p>If you want to, <code>page_sidebar</code>&nbsp;creates a sidebar layout that fills the page, and is a quick way to create a page with a sidebar. If you‚Äôd like to create a floating sidebar layout that can appear anywhere on the page, use&nbsp;<code>page_fluid</code>&nbsp;and&nbsp;<code>layout_sidebar</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Floating sidebar layout</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_fluid</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_sidebar</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sidebar =</span> <span class="fu">sidebar</span>(<span class="st">"Sidebar"</span>), <span class="co"># sidebar elements</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>   <span class="st">"Main contents"</span> <span class="co"># Main pannel elements</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/step2-fluid-page.PNG" class="img-fluid"></p>
<p>You‚Äôll notice here that the side bar and main contents panes are much smaller now, this is because <code>page_fluid()</code> allows the contents to scale to the required window size to fit the content.</p>
<p>Shiny also allows for more complex layouts too including options for example,&nbsp;<code>page_navbar</code>&nbsp;creates a multi-page user interface that includes a navigation bar. This layout is great for multistage analysis or reporting.</p>
<p><img src="images/navbars.PNG" class="img-fluid"></p>
<p>Another option for creating multipage dashbaords is through the Tabs</p>
<p><img src="images/tabs-nav.PNG" class="img-fluid"></p>
<p>We will stick to using a single page app today but everything we learn can be applied to controlling multipage apps in the future!</p>
</section>
<section id="layout-elements" class="level2">
<h2 class="anchored" data-anchor-id="layout-elements">Layout Elements</h2>
<section id="cards" class="level3">
<h3 class="anchored" data-anchor-id="cards"><code>Cards()</code></h3>
<p>Now we have out sidebar and main panel, we can also add containers to the main panel that will house out our data visualisations, <code>cards()</code> are a common organising unit in modern dashboards.</p>
<p>You can use the function&nbsp;<code>card()</code>&nbsp;to create a card in your Shiny app. <code>card()</code>&nbsp;creates a regular container with borders and padding.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_fluid</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_sidebar</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sidebar =</span> <span class="fu">sidebar</span>(<span class="st">"Sidebar"</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Main contents"</span>, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># including a card container in the main panel</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">height=</span><span class="dv">400</span> <span class="co"># setting the height of the card to ensure we can see it when empty.</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  )   </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/step3-cards1.PNG" class="img-fluid"></p>
<p>Use cards to present grouped and related information. Add content to a card by supplying arguments to <code>card()</code>.</p>
<p>Card item functions create various different parts to the card:</p>
<ul>
<li><p><code>card_header()</code> - A header (with border and background color) for the <code>card()</code>. Typically appears before a <code>card_body()</code>.</p></li>
<li><p><code>card_footer()</code> - A header (with border and background color) for the <code>card()</code>. Typically appears after a <code>card_body()</code>.</p></li>
<li><p><code>card_boady()</code> - A general container for the ‚Äúmain content‚Äù</p></li>
</ul>
</section>
<section id="exercise-1" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1">Exercise 1</h3>
<ol type="1">
<li>Use the above elements to add a <code>card_header()</code>, <code>card_footer()</code> and <code>card_body()</code> to our current application - <strong>Hint:</strong> try adding some plain text in ‚Äù ‚Äù to each of the elements.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Show Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inclduing card elements</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_fluid</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_sidebar</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sidebar =</span> <span class="fu">sidebar</span>(<span class="st">"Sidebar"</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Main contents"</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">height=</span><span class="dv">400</span>, <span class="co">#height set to 400 pixels</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">full_screen =</span> <span class="cn">TRUE</span>,  <span class="co">#allow card to expand if full screnn button is clicked </span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_header</span>(<span class="st">"A Header"</span>), <span class="co"># add a header</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_body</span>(<span class="st">"Card Body"</span>),  <span class="co"># add main body </span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_footer</span>(<span class="st">"A Footer"</span>)  <span class="co"># add footer</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  )   </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/step3-cards2.PNG" class="img-fluid"></p>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>We‚Äôll be using <code>cards()</code> alot in this tutorial to house the elements of our dashboard. See the <code>bslib</code> <a href="https://rstudio.github.io/bslib/articles/cards/?_gl=1*b31cr8*_ga*MzI4NDUyMTQwLjE3MTU4NDE0Mjg.*_ga_8QJS108GF1*czE3NTAzNzY0NzckbzM5JGcxJHQxNzUwMzc2ODI1JGo0OCRsMCRoMA..*_ga_2C0WZ1JHG0*czE3NTAzNzY0NzckbzUyJGcxJHQxNzUwMzc2ODI1JGo0OCRsMCRoMA..">Cards article</a> to learn more about cards.</p>
</blockquote>
</section>
<section id="value_boxes" class="level3">
<h3 class="anchored" data-anchor-id="value_boxes"><code>value_boxes()</code></h3>
<p>Value boxes are another useful UI component. Use value boxes to highlight important values in your app.</p>
<p>Create a value box with the function&nbsp;<code>value_box()</code>.</p>
<p>A <a href="https://rstudio.github.io/bslib/reference/value_box.html"><code>value_box()</code></a> has 4 main parts:</p>
<ol type="1">
<li><p><code>value</code>: Some text value.</p></li>
<li><p><code>title</code>: Optional text to display above <code>value</code>.</p></li>
<li><p><code>showcase</code>: Optional UI element(s) to display alongside the value.</p></li>
<li><p><code>theme</code>: Optional theme to change the appearance of the value box.</p></li>
<li><p><code>...</code>: Any other text/UI elements to appear below <code>value</code>.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_fluid</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#-layout------------------------</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_sidebar</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-sidebar---------</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sidebar =</span> <span class="fu">sidebar</span>(<span class="st">"Sidebar"</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-main pannel content----</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Main contents"</span>, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Value Box     </span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">value_box</span>(</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Value box"</span>, <span class="co"># Title</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="dv">750</span>          <span class="co"># Value to show </span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Card </span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">height=</span><span class="dv">400</span>, </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_header</span>(<span class="st">"A Header"</span>), </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_body</span>(<span class="st">"Card Body"</span>), </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_footer</span>(<span class="st">"A Footer"</span>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  )   </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/step4-value-boxes.PNG" class="img-fluid"></p>
<p>To make our value boxes stand-out even more we can enhance their appearance through setting their theme colour and including inforgraphic icons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">value_box</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Value box"</span>, <span class="co"># Title</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="dv">750</span>,         <span class="co"># Value to show</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"laptop"</span>), <span class="co">#include an icon</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">theme =</span> <span class="st">"pink"</span> <span class="co"># change the box theme colour</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note: to use Bootstrap icons, use the function&nbsp;<a href="https://rstudio.github.io/bsicons/reference/bs_icon.html"><code>bsicons::bs_icon()</code></a></p>
<p>Check out the library of avaliable icons <a href="https://icons.getbootstrap.com/">here</a></p>
<p>We can change the location of <code>value_boxes()</code> using the <code>showcase_layout()</code> arguement - options include <code>"left center"</code>, <code>"top-right"</code>. or <code>"bottom"</code></p>
</div>
</div>
</section>
<section id="exercise-2" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2">Exercise 2</h3>
<ol start="2" type="1">
<li>Add an addiditional <code>value_box()</code> and <code>card()</code> to your current dashboard. Set the <code>card()</code> to a different height and choose a new icon, theme and icon placement for the addiditional <code>value_box()</code>
<ul>
<li><strong>Hint:</strong> Bootstrap‚Äôs theme colors are drawn from&nbsp;<a href="https://getbootstrap.com/docs/5.3/customize/color/#all-colors">a second color list</a>&nbsp;that includes variations on several main colors, named literally. These colors include&nbsp;<code>"blue"</code>,&nbsp;<code>"purple"</code>,&nbsp;<code>"pink"</code>,&nbsp;<code>"red"</code>,&nbsp;<code>"orange"</code>,&nbsp;<code>"yellow"</code>,&nbsp;<code>"green"</code>,&nbsp;<code>"teal"</code>, and&nbsp;<code>"cyan"</code>.</li>
</ul></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Show Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_fluid</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#-layout------------------------</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_sidebar</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-sidebar---------</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sidebar =</span> <span class="fu">sidebar</span>(<span class="st">"Sidebar"</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-main pannel content----</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Main contents"</span>, </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Value Box     </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">value_box</span>(</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Value box"</span>, <span class="co"># Title</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="dv">750</span>,         <span class="co"># Value to show</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"laptop"</span>), <span class="co">#include an icon</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">theme =</span> <span class="st">"pink"</span> <span class="co"># change the box theme colour</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># second value box </span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">value_box</span>(</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Value box 2"</span>, </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="dv">1993</span>, </span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"calendar"</span>), </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">theme =</span> <span class="st">"blue"</span> </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Card </span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">height=</span><span class="dv">400</span>, </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_header</span>(<span class="st">"A Header"</span>), </span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_body</span>(<span class="st">"Card Body"</span>), </span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_footer</span>(<span class="st">"A Footer"</span>)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Second card box </span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">height =</span> <span class="dv">200</span>, </span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">full_screen =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_header</span>(<span class="st">"Another Header"</span>), </span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_body</span>(<span class="st">"Another Card"</span>), </span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_footer</span>(<span class="st">"Another Footer"</span>)</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  )   </span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/exercise-2-answer.PNG" class="img-fluid"></p>
</div>
</div>
</div>
</section>
</section>
<section id="adjusting-layout-positions" class="level2">
<h2 class="anchored" data-anchor-id="adjusting-layout-positions">Adjusting Layout Positions</h2>
<p>By default, when you add multiple elements to your main panel, Shiny will place them one after another vertically (i.e., one long column). But as we build real dashboards, we often want to organize elements <em>horizontally</em> or into <em>grids</em> to create a cleaner and more informative user interface.</p>
<p>This is where layout functions like <code>layout_columns()</code> and <code>layout_column_wrap()</code> come in.</p>
<section id="layout_columns" class="level3">
<h3 class="anchored" data-anchor-id="layout_columns"><code>layout_columns()</code></h3>
<p>The function <code>layout_columns()</code> allows you to place elements next to each other, specifying how many columns wide each element should be. Shiny divides the available space into 12 columns . You can assign any number of columns to each element, as long as they add up to 12 or less.</p>
<p>Let‚Äôs try adding moving our two value boxes side by side:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_fluid</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#-layout------------------------</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_sidebar</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-sidebar---------</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sidebar =</span> <span class="fu">sidebar</span>(<span class="st">"Sidebar"</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-main pannel content----</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Main contents"</span>, </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Value Boxes in a single row</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>(    </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">value_box</span>(</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Value box"</span>, <span class="co"># Title</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="dv">750</span>,         <span class="co"># Value to show</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"laptop"</span>), <span class="co">#include an icon</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">theme =</span> <span class="st">"pink"</span> <span class="co"># change the box theme colour</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">value_box</span>(</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Value box 2"</span>, </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="dv">1993</span>, </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"calendar"</span>), </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">theme =</span> <span class="st">"blue"</span> </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Card </span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">height=</span><span class="dv">400</span>, </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_header</span>(<span class="st">"A Header"</span>), </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_body</span>(<span class="st">"Card Body"</span>), </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_footer</span>(<span class="st">"A Footer"</span>)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Second card box </span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">height =</span> <span class="dv">200</span>, </span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">full_screen =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_header</span>(<span class="st">"Another Header"</span>), </span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_body</span>(<span class="st">"Another Card"</span>), </span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_footer</span>(<span class="st">"Another Footer"</span>)</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  )   </span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/layout-cols1.PNG" class="img-fluid"></p>
<p><code>layout_columns()</code> automatically places the two value boxes next to each other. By default, each element inside <code>layout_columns()</code> takes up equal space. If you want more control, you can specify <code>col_widths</code> for each element /12 e.g.&nbsp;<code>col_widths``= c(6, 6)</code>.</p>
</section>
<section id="exercise-3" class="level3">
<h3 class="anchored" data-anchor-id="exercise-3">Exercise 3</h3>
<ol start="3" type="1">
<li>Use <code>layout_columns()</code> to set the <code>card()</code> elements into two columns. What do you notice about the height of the cards?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Show Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_fluid</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#-layout------------------------</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_sidebar</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-sidebar---------</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sidebar =</span> <span class="fu">sidebar</span>(<span class="st">"Sidebar"</span>),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-main pannel content----</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Main contents"</span>, </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Value Boxes in a single row</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>( </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Value box"</span>, <span class="co"># Title</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="dv">750</span>,         <span class="co"># Value to show</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"laptop"</span>), <span class="co">#include an icon</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"pink"</span> <span class="co"># change the box theme colour</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Value box 2"</span>, </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="dv">1993</span>, </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"calendar"</span>), </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"blue"</span> </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cards in a single row</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>(</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">height=</span><span class="dv">400</span>, </span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"A Header"</span>), </span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="st">"Card Body"</span>), </span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"A Footer"</span>)</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">200</span>, </span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Another Header"</span>), </span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="st">"Another Card"</span>), </span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Another Footer"</span>)</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>    )   </span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The two cards are now the same height as the tallest card. This is because <code>layout_columns()</code> automatically sets the height of each column to match the tallest element in that row.</p>
<p><img src="images/layout-cols2.PNG" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="layout_column_wrap" class="level3">
<h3 class="anchored" data-anchor-id="layout_column_wrap"><code>layout_column_wrap()</code></h3>
<p>If you have many elements and want them to automatically wrap onto multiple rows (like a responsive grid), you can use <code>layout_column_wrap()</code>.</p>
<p>For example, you might want to display six value boxes, but have them wrap automatically depending on screen size:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_fluid</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#-layout------------------------</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_sidebar</span>(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-sidebar---------</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sidebar =</span> <span class="fu">sidebar</span>(<span class="st">"Sidebar"</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-main pannel content----</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Main contents"</span>, </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Value Boxes in a single row that wraps responsive to screen size</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_column_wrap</span>( </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Value box"</span>, <span class="co"># Title</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="dv">750</span>,         <span class="co"># Value to show</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"laptop"</span>), <span class="co">#include an icon</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"pink"</span> <span class="co"># change the box theme colour</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Value box 2"</span>, </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="dv">1993</span>, </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"calendar"</span>), </span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"blue"</span> </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># addiditional boxes</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(<span class="at">title =</span> <span class="st">"Value box 3"</span>, <span class="at">value =</span> <span class="dv">123</span>), </span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(<span class="at">title =</span> <span class="st">"Value box 4"</span>, <span class="at">value =</span> <span class="dv">456</span>), </span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(<span class="at">title =</span> <span class="st">"Value box 5"</span>, <span class="at">value =</span> <span class="dv">789</span>), </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(<span class="at">title =</span> <span class="st">"Value box 6"</span>, <span class="at">value =</span> <span class="dv">101112</span>)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cards in a single row</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>(</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">height=</span><span class="dv">400</span>, </span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"A Header"</span>), </span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="st">"Card Body"</span>), </span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"A Footer"</span>)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">200</span>, </span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Another Header"</span>), </span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="st">"Another Card"</span>), </span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Another Footer"</span>)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>    )   </span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/layout-cols3.PNG" class="img-fluid quarto-figure quarto-figure-left figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-right">
<figure class="figure">
<p><img src="images/layout-cols4.PNG" class="img-fluid quarto-figure quarto-figure-right figure-img"></p>
</figure>
</div>
<p>This makes your app much more responsive: as users resize their browser window, the layout adjusts automatically.</p>
</section>
</section>
<section id="widget-control-elements" class="level2">
<h2 class="anchored" data-anchor-id="widget-control-elements">Widget Control Elements</h2>
<p>Now that we‚Äôve set up a clean layout using <code>bslib</code>, let‚Äôs add some interactive functionality, the sidebar is where we direct the user to select inputs the will send messages to the Shiny app. Shiny widgets collect a value from your user. When a user changes the widget, the value will change as well.</p>
<section id="choosing-the-right-input-controls-a-quick-exploration" class="level3">
<h3 class="anchored" data-anchor-id="choosing-the-right-input-controls-a-quick-exploration">Choosing the Right Input controls: A Quick Exploration</h3>
<p>Before we add our first user input, it‚Äôs helpful to understand a few common types of <strong>control widgets</strong> in Shiny and when to use them. Inputs allow users to interact with the webpage by clicking a button, entering text, selecting an option, and more.</p>
<p>Shiny provides <a href="https://shiny.posit.co/r/components/">several ways</a> for users to make selections here are a couple of options:<br>
</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input Type</th>
<th>Function</th>
<th>When to Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://shiny.posit.co/r/components/inputs/select-single/">Dropdown menu</a></td>
<td><code>selectInput()</code></td>
<td>‚úÖ Best for <strong>long lists</strong> ‚Äî compact and searchable</td>
</tr>
<tr class="even">
<td><a href="https://shiny.posit.co/r/components/inputs/radio-buttons/">Radio buttons</a></td>
<td><code>radioButtons()</code></td>
<td>‚úÖ Best for <strong>short lists</strong> with a few clear options (e.g., Yes/No, 3-4 choices)</td>
</tr>
<tr class="odd">
<td><a href="https://shiny.posit.co/r/components/inputs/checkbox/">Checkbox group</a></td>
<td><code>checkboxGroupInput()</code></td>
<td>‚úÖ Best for selecting <strong>multiple options</strong></td>
</tr>
<tr class="even">
<td><a href="https://shiny.posit.co/r/components/inputs/selectize-single/">Autocomplete select</a></td>
<td><code>selectizeInput()</code></td>
<td>‚úÖ Similar to <code>selectInput()</code>, but includes <strong>type-ahead search</strong> by default</td>
</tr>
<tr class="odd">
<td><a href="https://shiny.posit.co/r/components/inputs/checkbox/">Single checkbox</a></td>
<td><code>checkboxInput()</code></td>
<td>‚úÖ Best for simple <strong>on/off</strong>, <strong>true/false</strong> inputs</td>
</tr>
<tr class="even">
<td><a href="https://shiny.posit.co/r/components/inputs/slider/">Slider</a></td>
<td><code>sliderInput()</code></td>
<td>‚úÖ Best for selecting <strong>continuous values</strong> or <strong>ranges</strong></td>
</tr>
<tr class="odd">
<td><a href="https://shiny.posit.co/r/components/inputs/numeric-input/">Numeric input</a></td>
<td><code>numericInput()</code></td>
<td>‚úÖ Best for <strong>precise numeric entry</strong></td>
</tr>
<tr class="even">
<td><a href="https://shiny.posit.co/r/components/inputs/text-area/">Text input</a></td>
<td><code>textAreaInput()</code></td>
<td>‚úÖ Best for <strong>free text entry</strong> (e.g.&nbsp;names, IDs, labels)</td>
</tr>
<tr class="odd">
<td><a href="https://shiny.posit.co/r/components/inputs/date-selector/">Date input</a></td>
<td><code>dateInput()</code></td>
<td>‚úÖ Best for selecting a <strong>single date</strong></td>
</tr>
<tr class="even">
<td><a href="https://shiny.posit.co/r/components/inputs/date-range-selector/">Date range input</a></td>
<td><code>dateRangeInput()</code></td>
<td>‚úÖ Best for selecting a <strong>start and end date</strong></td>
</tr>
<tr class="odd">
<td><a href="https://shiny.posit.co/r/components/inputs/file-input/">File upload</a></td>
<td><code>fileInput()</code></td>
<td>‚úÖ Best for allowing users to <strong>upload files</strong></td>
</tr>
<tr class="even">
<td><a href="https://shiny.posit.co/r/components/inputs/action-button/">Action button</a></td>
<td><code>actionButton()</code></td>
<td>‚úÖ Best for triggering <strong>explicit actions</strong> (e.g.&nbsp;submit, run model)</td>
</tr>
</tbody>
</table>
<p>Each widget function requires several arguments. The first two arguments for each widget are</p>
<ul>
<li><p>a <strong>name for the widget</strong>: The user will not see this name, but you can use it to access the widget‚Äôs value. The name should be a character string.</p></li>
<li><p>a <strong>label</strong>: This label will appear with the widget in your app. It should be a character string, but it can be an empty string <code>""</code>.</p></li>
</ul>
<p>In this example, the name is ‚Äúaction‚Äù and the label is ‚ÄúAction‚Äù: <code>actionButton("action", label = "Action")</code></p>
<p>The remaining arguments vary from widget to widget, depending on what the widget needs to do its job. They include things like initial values, ranges, and increments. You can find the exact arguments needed by a widget on the widget function‚Äôs help page, (e.g.,&nbsp;<code>?selectInput</code>).</p>
</section>
<section id="exercise-4" class="level3">
<h3 class="anchored" data-anchor-id="exercise-4">Exercise 4</h3>
<ol start="4" type="1">
<li>For our dashboard, we want to be able to select a single province to display our data - lets test out some of these examples above and select the most appropriate option for our dashboard.</li>
</ol>
<p>Replace your <code>sidebar</code> code with the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sidebar <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p</span>(<span class="st">"Test different input styles. Which one works best for selecting a province from a long list?"</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">selectInput</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">inputId =</span> <span class="st">"dropdown_test"</span>, <span class="co"># ID name that can pass to the server as input$dropdown_test for processing</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Dropdown input (selectInput):"</span>, <span class="co"># Title the user sees on the UI</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">choices =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(app_data<span class="sc">$</span>organisation_unit)) <span class="co"># values to shown in the list drawn from all the unit names in our dataset</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">radioButtons</span>(</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">inputId =</span> <span class="st">"radio_test"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Radio buttons (radioButtons):"</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">choices =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(app_data<span class="sc">$</span>organisation_unit))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">checkboxGroupInput</span>(</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">inputId =</span> <span class="st">"checkbox_test"</span>,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Checkbox group (checkboxGroupInput):"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">choices =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(app_data<span class="sc">$</span>organisation_unit))</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Reflect:</p>
<ul>
<li><p>What happens when the list is long?</p></li>
<li><p>Which is more space-efficient?</p></li>
<li><p>What would help users most?</p></li>
</ul>
</blockquote>
<div class="callout callout-style-default callout-tip callout-titled" title="Show Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For this app, we‚Äôll use <code>selectInput()</code> because:</p>
<ul>
<li><p>We have many provinces to choose from</p></li>
<li><p>We only need one selection at a time</p></li>
<li><p>It‚Äôs clean, compact, and familiar</p></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="putting-it-all-together" class="level2">
<h2 class="anchored" data-anchor-id="putting-it-all-together">Putting it all together</h2>
<p>Lets now create the skeleton of our dashboard. Firstly what we want to be able to do is allow user to select a <strong>Province</strong>.</p>
<p>We‚Äôll start by updating the <strong>UI</strong> to add a control widget that selects for province and in Part 2 we will address adding reactive elements to our output containers.</p>
<p>Let‚Äôs now update the sidebar to add a proper dropdown input for Province selection. Remember to ensure we are reading in our dataset prior to the UI and Server code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>   <span class="co">#-sidebar---------</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    sidebar <span class="ot">=</span> <span class="fu">sidebar</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add user input selection </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>(<span class="st">"User Inputs"</span>), <span class="co"># Title</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"province_select"</span>,  <span class="co"># ID value</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Select a Province:"</span>, <span class="co"># UI side Title</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="fu">sort</span>(<span class="fu">unique</span>(app_data<span class="sc">$</span>organisation_unit))), <span class="co"># empty first value followed by all of our unique org_unit names</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected =</span> <span class="st">""</span> <span class="co"># default value that the application starts with as selected - in our case we want this to be blank. </span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>      ),</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>What this is doing:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Function/Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>selectInput()</code></td>
<td>Adds a dropdown input where users can choose a Province</td>
</tr>
<tr class="even">
<td><code>inputId = "province_select"</code></td>
<td>This ID connects the UI to the server logic (we‚Äôll use it in Part 2)</td>
</tr>
<tr class="odd">
<td><code>choices = ...</code></td>
<td>Pulls all Province names from the dataset and sorts them alphabetically</td>
</tr>
<tr class="even">
<td><code>selected = NULL</code></td>
<td>No Province is pre-selected when the app first loads</td>
</tr>
</tbody>
</table>
<p><img src="images/user-inputs1.PNG" class="img-fluid"></p>
</section>
<section id="pause-reflect-where-we-are" class="level2">
<h2 class="anchored" data-anchor-id="pause-reflect-where-we-are">Pause &amp; Reflect: Where We Are</h2>
<p>Before we move forward, take a quick moment to review what you‚Äôve built so far:</p>
<p>‚úÖ You‚Äôve created your own Shiny app from scratch.</p>
<p>‚úÖ You set up a modern dashboard layout using <code>bslib::page_fluid()</code> and <code>layout_sidebar()</code></p>
<p>‚úÖ You‚Äôve learned how to organize content using:</p>
<ul>
<li><p><code>card()</code> to hold your future plots and tables</p></li>
<li><p><code>value_box()</code> to display key summary indicators</p></li>
<li><p><code>layout_columns()</code> and <code>layout_column_wrap()</code> to control the page structure</p></li>
</ul>
<p>‚úÖ You‚Äôve explored how to place <strong>interactive control widgets</strong> into the sidebar using <code>selectInput()</code>, which will allow users to filter the data.</p>
<section id="quick-self-check-questions" class="level3">
<h3 class="anchored" data-anchor-id="quick-self-check-questions">Quick self-check questions</h3>
<ul>
<li><p>Do you understand the difference between <strong>UI</strong> and <strong>Server</strong> parts of the app?</p></li>
<li><p>Can you identify where the user interacts (inputs) vs where outputs will be displayed?</p></li>
<li><p>Do you feel comfortable adding more cards, value boxes, or inputs to your app?</p></li>
</ul>
</section>
</section>
</section>
<section id="part-2-reactivty-and-rendering-output" class="level1">
<h1>Part 2 Reactivty and Rendering output</h1>
<p>In Part 2, you will learn:</p>
<ul>
<li><p>How to add display elements into the dashbaord cards.</p></li>
<li><p>How to connect your <code>selectInput()</code> dropdown to your dataset.</p></li>
<li><p>How to filter data reactively based on user selections.</p></li>
<li><p>How to update your value boxes and outputs automatically when the user interacts.</p></li>
</ul>
<p>In Shiny, <strong>reactive expressions</strong> automatically update when the user interacts with your app.</p>
<section id="shiny-output-types" class="level2">
<h2 class="anchored" data-anchor-id="shiny-output-types">Shiny Output Types</h2>
<p>You can create reactive outputs with a two step process.</p>
<ol type="1">
<li><p>Add an R object to your user interface.</p></li>
<li><p>Tell Shiny how to build the object in the server function. The object will be reactive if the code that builds it calls a widget value.</p></li>
</ol>
<p>Shiny provides a <a href="https://shiny.posit.co/r/components/">family of functions</a> that turn R objects into output for your user interface. Each function creates a specific type of output.</p>
<p><img src="images/shiny-output-types.PNG" class="img-fluid"></p>
<p>Below is a summary of some key output types, the functions to tell shiny what the expect in the UI and the functions to create it in the server and a short desciption of when to use.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Output Type</th>
<th>Render Function (Server)</th>
<th>Display Function (UI)</th>
<th>When to Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Text</strong></td>
<td><code>renderText()</code></td>
<td><code>textOutput()</code></td>
<td>Display simple text strings</td>
</tr>
<tr class="even">
<td><strong>Tables (static)</strong></td>
<td><code>renderTable()</code></td>
<td><code>tableOutput()</code></td>
<td>Show small static tables</td>
</tr>
<tr class="odd">
<td><strong>Tables (interactive)</strong></td>
<td><code>renderDT()</code></td>
<td><code>DT::dataTableOutput()</code></td>
<td>Show sortable, searchable tables</td>
</tr>
<tr class="even">
<td><strong>Plots (static)</strong></td>
<td><code>renderPlot()</code></td>
<td><code>plotOutput()</code></td>
<td>Standard static plots (ggplot, base R plots)</td>
</tr>
<tr class="odd">
<td><strong>Plots (interactive)</strong></td>
<td><code>renderPlotly()</code></td>
<td><code>plotlyOutput()</code></td>
<td>Fully interactive plots (hover, zoom, pan)</td>
</tr>
<tr class="even">
<td><strong>Leaflet Maps</strong></td>
<td><code>renderLeaflet()</code></td>
<td><code>leafletOutput()</code></td>
<td>Interactive geographic maps</td>
</tr>
<tr class="odd">
<td><strong>Images</strong></td>
<td><code>renderImage()</code></td>
<td><code>imageOutput()</code></td>
<td>Display image files (PNG, JPG, etc.)</td>
</tr>
<tr class="even">
<td><strong>UI elements</strong> (dynamic)</td>
<td><code>renderUI()</code></td>
<td><code>uiOutput()</code></td>
<td>Dynamically generate any custom UI</td>
</tr>
<tr class="odd">
<td><strong>Value Boxes</strong></td>
<td><em>(no render function)</em></td>
<td><code>value_box()</code></td>
<td>Display single KPI summary values</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p>What you will notice is that Every output type has:</p>
<ul>
<li><p><strong>One render function</strong> ‚Üí goes in the server</p></li>
<li><p><strong>One output function</strong> ‚Üí goes in the UI</p></li>
</ul>
</blockquote>
<p>And you connect them using a shared <code>outputId</code></p>
</section>
<section id="building-reactive-outputs-ui-and-server-crosstalk" class="level2">
<h2 class="anchored" data-anchor-id="building-reactive-outputs-ui-and-server-crosstalk">Building Reactive Outputs: <code>ui</code> and <code>server</code> crosstalk</h2>
<p>Lets work through an example to display the Province that the user selected in the first card of our current dashboard.<br>
We want to show some text that says:</p>
<blockquote class="blockquote">
<p><em>‚ÄúYou have selected: [Province]‚Äù</em></p>
</blockquote>
<p>To do this, we add <code>textOutput()</code> to the UI where we want the text to appear,in this instance we add it to the <code>card_body()</code> call to our first card.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cards in a single row</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">height=</span><span class="dv">400</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"A Header"</span>), </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="fu">textOutput</span>(<span class="st">"selected_province_text"</span>)), <span class="co"># add textOutput to display selected province), </span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"A Footer"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">200</span>, </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Another Header"</span>), </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="st">"Another Card"</span>), </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Another Footer"</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice that&nbsp;<code>textOutput</code>&nbsp;takes an argument, the character string&nbsp;<code>"selected_province_text"</code>. Each of the&nbsp;<code>*Output</code>&nbsp;functions require a single argument: a character string that Shiny will use as the name of your reactive element. Your users will not see this name, but you will use it later.</p>
</div>
</div>
<p>Placing a function in <code>ui</code> tells Shiny where to display your object. Next, you need to tell Shiny how to build the object.</p>
<p>We do this by providing the R code that builds the object in the <code>server</code> function.</p>
<p>The <code>server</code> function plays a special role in the Shiny process; it builds a list-like object named <code>output</code> that contains all of the code needed to update the R objects in your app. Each R object needs to have its own entry in the list.</p>
<p>You can create an entry by defining a new element for <code>output</code> within the <code>server</code> function, like below. The element name should match the name of the reactive element that you created in the <code>ui</code>.</p>
<p>In the <code>server</code> function below, <code>output$selected_province_text</code> matches <code>textOutput("selected_province_text</code> <code>")</code> in your <code>ui</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>selected_province_text <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If nothing is selected, show a default message</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (input<span class="sc">$</span>province_select <span class="sc">==</span> <span class="st">""</span>) {</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"No Province Selected"</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># otherwise show the selected value</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">"You have selected:"</span>, input<span class="sc">$</span>province_select)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>input</code> is a second list-like object created by the server function. It stores the current values of all of the widgets in your app. These values will be saved under the names that you gave the widgets in your <code>ui</code>.</p>
<p>So for example, our app has one widget, one named <code>"province_select"</code> .The values of <code>"province_select"</code> will be saved in <code>input</code> as <code>input$province_select</code>.</p>
<p>Shiny will automatically make an object reactive if the object uses an <code>input</code> value. For example, the <code>server</code> function above creates a reactive line of text by calling the value of the select box widget to build the text.</p>
<p><img src="images/text-reactive.PNG" class="img-fluid"></p>
<p>When the user changes the province name the text outoput will update automatically - try this out.</p>
<p><strong>What you just learned:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Part</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>UI</td>
<td><code>textOutput("selected_province_text")</code></td>
</tr>
<tr class="even">
<td>Server</td>
<td><code>output$selected_province_text &lt;- renderText({ ... })</code></td>
</tr>
<tr class="odd">
<td>Link</td>
<td>Both use the same ID: <code>"selected_province_text"</code></td>
</tr>
</tbody>
</table>
<p>Each entry to <code>output$ &lt;-</code> should contain the output of one of Shiny‚Äôs <code>render*</code> functions. These functions capture an R expression and do some light pre-processing on the expression. Use the <code>render*</code> function that corrresponds to the type of reactive object you are making (Pairs are listed in the table above).</p>
<p>Each <code>render*</code> function takes a single argument: an R expression surrounded by braces, <code>{}</code>. The expression can be one simple line of text, or it can involve many lines of code, as if it were a complicated function call.</p>
<p>Think of this R expression as a set of instructions that you give Shiny to store for later. Shiny will run the instructions when you first launch your app, and then Shiny will re-run the instructions every time it needs to update your object.</p>
<p>For this to work, your expression should return the object you have in mind (a piece of text, a plot, a data frame, etc.). You will get an error if the expression returns the wrong type of object.</p>
</section>
<section id="reactivity-and-data" class="level2">
<h2 class="anchored" data-anchor-id="reactivity-and-data">Reactivity and Data</h2>
<p>In the previous step our app simply reacts to the user input and displays the Province - now we want to also tell our App to do more with that information by filtering and displaying summary data from our DHIS2 data pull.</p>
<p>We want to compute (for now, keep it simple):</p>
<ul>
<li>Total number of malaria cases reported in the selected province for the year</li>
</ul>
<p>We know our dataset is called <code>app_data</code>, and malaria cases are stored where <code>var_name == "malaria_cases"</code>.</p>
<p>Inside your <code>server()</code> function, add:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reactive data filter - filter the app_data when input value is selected</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  province_data <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>province_select <span class="sc">!=</span> <span class="st">""</span>)  <span class="co"># Only run if province selected</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    app_data <span class="sc">%&gt;%</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(organisation_unit <span class="sc">==</span> input<span class="sc">$</span>province_select) <span class="co"># filter dataset to Province selected</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute total cases from filtered data</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>total_cases_box <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">province_data</span>() <span class="co"># this act like a function and pulls through our filtered data to an object inside renderText called 'df'</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    total_cases <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(var_name <span class="sc">==</span> <span class="st">"malaria_cases"</span>) <span class="sc">%&gt;%</span> <span class="co"># filters to malaria cases data only</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> <span class="co"># sums values over all periods included</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pull</span>(total) <span class="co"># pulls out the value from summary calculation into named vector</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    total_cases <span class="co"># final value</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we have made our <code>province_data()</code> object <em>reactive</em> - what this means is that every time <code>input$province_select</code> changes, Shiny will automatically re-execute any code that depends on <code>province_data()</code>.</p>
<p>We use the filtered <code>province_data()</code> in the <code>output$total_cases_box</code> to then create a single value of total cases reported that year.</p>
<p>We‚Äôre using <code>renderText()</code> as our server side output function - we need to feed this information to our updated <code>value_box()</code> UI code next.</p>
<p>We want to replace the <code>value</code> argument with the dynamic text from our server <code>"total_cases_box"</code>. In your <code>ui</code>, replace the original value box with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">value_box</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Total Cases Reported"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span>  <span class="fu">textOutput</span>(<span class="st">"total_cases_box"</span>), <span class="co"># reactive value taken from server side outputs</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"journal-medical"</span>),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"pink"</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/reactive-value-box.PNG" class="img-fluid"></p>
<p><strong>Summary of updates</strong></p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td>Reactive filter</td>
<td><code>province_data &lt;- reactive({ ... })</code></td>
</tr>
<tr class="even">
<td>Computation</td>
<td><code>summarise()</code> inside <code>renderText()</code></td>
</tr>
<tr class="odd">
<td>Output rendering</td>
<td><code>output$total_cases_box &lt;- renderText({ ... })</code></td>
</tr>
<tr class="even">
<td>UI linkage</td>
<td><code>value = textOutput("total_cases_box")</code></td>
</tr>
</tbody>
</table>
<section id="exercise-5" class="level3">
<h3 class="anchored" data-anchor-id="exercise-5">Exercise 5</h3>
<ol start="5" type="1">
<li>Update the second value box to compute and display total annual tests (<code>var_name == "malaria_tests"</code>), update the icon to match the data reporting type, and remove the remaining value boxes for now,</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Show Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># update the value box to contain a renderOutput call</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">value_box</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Total Tests Reported"</span>, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="fu">textOutput</span>(<span class="st">"total_tests_box"</span>), <span class="co">#render output call</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"journal-medical"</span>), <span class="co"># update icon</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"blue"</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#-Compute total tests from filtered data--------------------------------------------</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>total_tests_box <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">province_data</span>() <span class="co"># pull filtered province data</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    total_tests <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(var_name <span class="sc">==</span> <span class="st">"malaria_tests"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> <span class="co">#sum total tesats</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pull</span>(total)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    total_tests <span class="co"># return value</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/value-box-2-with-test-data.PNG" class="img-fluid"></p>
</div>
</div>
</div>
<p>Good job! We‚Äôll come back to our value boxes later to add more functionality, but for now let‚Äôs focus on adding a time series plot to visualize the reported malaria cases over time.</p>
</section>
</section>
<section id="adding-a-reactive-plot" class="level2">
<h2 class="anchored" data-anchor-id="adding-a-reactive-plot">Adding a Reactive Plot</h2>
<p>Now that we have our value boxes displaying total cases and tests, let‚Äôs add a time series plot to visualize malaria cases over time for the selected Province.</p>
<p>We‚Äôll use: <code>plotlyOutput()</code> in our UI card to reserve a space for an interactive chart.</p>
<p>Lets update one of our existing cards to include a plotly output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout_columns</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">height=</span><span class="dv">400</span>, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Monthly Malaria Cases"</span>),    <span class="co"># informative card header</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="fu">plotlyOutput</span>(<span class="st">"ts_plot"</span>)),      <span class="co"># include plotlyOutput in the card body and name this output ts_plot</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Data source: DHIS2 export"</span>) <span class="co">#informative card footer</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">200</span>, </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Another Header"</span>), </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="st">"Another Card"</span>), </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Another Footer"</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This creates a card with a header, a plotly output area, and a footer. The <code>plotlyOutput("ts_plot")</code> is where our time series plot will go.</p>
<p>Now that we‚Äôve created a space for our plot in the UI, it‚Äôs time to write the <strong>server-side logic</strong> that:</p>
<ol start="2" type="1">
<li><p>Creates a time series plot of malaria cases</p></li>
<li><p>Displays that plot inside the <code>ts_plot</code> output that we just specified</p></li>
</ol>
<p>Add the following code to the <code>server</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-Plot of reported cases over time selected by province---------------------------------</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>ts_plot <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">province_data</span>()  <span class="sc">%&gt;%</span>  <span class="co"># get province data</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(var_name <span class="sc">==</span> <span class="st">"malaria_cases"</span>) <span class="co"># reduce to cases</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">req</span>(<span class="fu">nrow</span>(df) <span class="sc">&gt;</span> <span class="dv">0</span>)              <span class="co"># Ensure there are rows to plot</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create a ggplot time series of time on the xaxis cases on the y</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span>  <span class="co">#add line style</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># add points to the line</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Confirmed Malaria Cases in:"</span>, input<span class="sc">$</span>province_select), <span class="co"># add selected province to the title</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Confirmed Cases"</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>()</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Convert ggplot to interactive Plotly object</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplotly</span>(p)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What this is doing:</p>
<ul>
<li><p><code>renderPlotly()</code>: Tells Shiny how to render the <code>plotlyOutput()</code> in the UI</p></li>
<li><p><code>ggplot()</code>: creates a time series plot with <code>geom_line()</code> to show the trend of confirmed cases over time.</p></li>
<li><p><code>ggplotly()</code>: converts the ggplot object to a Plotly object for interactivity.</p></li>
</ul>
<p><img src="images/first-plot-card.PNG" class="img-fluid"></p>
<p><strong>Test It</strong></p>
<p>Run your app and try the following:</p>
<ul>
<li><p>Select a Province from the dropdown</p></li>
<li><p>Watch the plot appear in the card</p></li>
<li><p>Hover over points to see values</p></li>
<li><p>Try selecting a different Province, the plot updates automatically!</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>üìä <a href="https://plotly.com/r/">Plotly</a> <strong>for Interactive Plots</strong></p>
<p>The <a href="https://plotly.com/r/">Plotly</a> package allows you to turn static <code>ggplot2</code> charts into interactive visualizations. This means users can <strong>hover over points</strong>, <strong>zoom in</strong>, <strong>pan across the plot</strong>, and <strong>see tooltips</strong> with data values.</p>
<p>In Shiny, this is especially useful for dashboards where you want dynamic, user-driven exploration of your data.</p>
<p>We use the <code>ggplotly()</code> function to <strong>convert a regular <code>ggplot</code> object into a Plotly object</strong>, making it fully interactive with minimal changes to your code.</p>
<p>Just remember that not all <code>ggplot2</code> features translate perfectly, some customization may require testing or tweaking. Or you can always build plots directly using Plotly code but for now we‚Äôll stick with ggplot &gt; ploty conversion.</p>
</div>
</div>
<section id="exercise-6--7" class="level3">
<h3 class="anchored" data-anchor-id="exercise-6--7">Exercise 6 -7:</h3>
<blockquote class="blockquote">
<ol type="1">
<li>Modify the plot to include both confirmed cases and malaria tests as two lines (different colors). <strong>Hint: check back in your DHIS2 extraction slides for an example plotting multiple indicators</strong>. <strong>Hint: edit the <code>var_name %in% c()</code>filter to select both indicators.</strong> Once rendered plotly has an option to view both hover labels at the same time - see if you can make this work in your local app.</li>
</ol>
</blockquote>
<div class="callout callout-style-default callout-tip callout-titled" title="Show Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>First update the card header</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">card</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">height=</span><span class="dv">400</span>, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Monthly Malaria Indicators"</span>),    <span class="co"># Update informative card header</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="fu">plotlyOutput</span>(<span class="st">"ts_plot"</span>)),     </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Data source: DHIS2 export"</span>) </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Add the addiditional variable call in the filter and include plot colours - here i‚Äôve selected those in AMMnet Branding.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-Plot of reported values over time selected by province---------------------------------------</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a> output<span class="sc">$</span>ts_plot <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">province_data</span>()  <span class="sc">%&gt;%</span>  <span class="co"># get province data</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(var_name <span class="sc">%in%</span>  <span class="fu">c</span>(<span class="st">"malaria_cases"</span>, <span class="st">"malaria_tests"</span>)) <span class="co"># reduce to cases AND tests</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">req</span>(<span class="fu">nrow</span>(df) <span class="sc">&gt;</span> <span class="dv">0</span>)              <span class="co"># Ensure there are rows to plot</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create a ggplot time series of time on the xaxis cases on the y, colour by data type</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> value, <span class="at">col=</span>var_name)) <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span>  <span class="co">#add line style</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># add points to the line</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Malaria Indicators Cases in:"</span>, input<span class="sc">$</span>province_select), <span class="co"># add selected province to the title and change name</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Value"</span>,   <span class="co"># Update</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"Indicator"</span> <span class="co"># Update </span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"malaria_cases"</span> <span class="ot">=</span> <span class="st">"#571845"</span>, <span class="st">"malaria_tests"</span> <span class="ot">=</span> <span class="st">"#C42847"</span>))<span class="sc">+</span> <span class="co"># set the colour values</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>()</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Convert ggplot to interactive Plotly object</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplotly</span>(p)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<blockquote class="blockquote">
<ol start="2" type="1">
<li>Add a new <strong>input selection</strong> that lists the two data elements (‚Äúconfirmed cases‚Äù, ‚Äúmalaria tests‚Äù) so users can toggle which series appear. Hint use: <a href="https://shiny.posit.co/r/reference/shiny/1.7.4/checkboxgroupinput.html"><code>checkboxGroupInput()</code></a> to allow multiple selections to be toggeled on and off. <strong>Hint</strong> think carefully about how to use the new <code>input$</code> value to filter the dataset.</li>
</ol>
</blockquote>
<div class="callout callout-style-default callout-tip callout-titled" title="üí° Show Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
üí° Show Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-sidebar---------</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    sidebar <span class="ot">=</span> <span class="fu">sidebar</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add user input selection </span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>(<span class="st">"User Inputs"</span>), <span class="co"># Title</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Province selection </span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"province_select"</span>,  <span class="co"># ID value</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Select a Province:"</span>, <span class="co"># UI side Title</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="fu">sort</span>(<span class="fu">unique</span>(app_data<span class="sc">$</span>organisation_unit))), <span class="co"># empty first value followed by all of our unique org_unit names</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected =</span> <span class="st">""</span> <span class="co"># default value that the application starts with as selected - in our case we want this to be blank. </span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Data series toggle </span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">checkboxGroupInput</span>(</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"series_select"</span>, <span class="co"># give usable ID</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Select data series:"</span>, <span class="co"># UI side title</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"Confirmed Cases"</span> <span class="ot">=</span> <span class="st">"malaria_cases"</span>, <span class="co"># filter variables with nice formatting for the UI</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Malaria Tests"</span>  <span class="ot">=</span> <span class="st">"malaria_tests"</span>),</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected =</span> <span class="cn">NULL</span> <span class="co">#ensure selection is empty initially</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-Plot of reported values over time selected by province---------------------------------------</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>ts_plot <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">province_data</span>()  <span class="sc">%&gt;%</span>  <span class="co"># get province data</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(var_name <span class="sc">%in%</span> input<span class="sc">$</span>series_select) <span class="co"># Get the filtered data as per input </span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">req</span>(<span class="fu">nrow</span>(df) <span class="sc">&gt;</span> <span class="dv">0</span>)              <span class="co"># Ensure there are rows to plot</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create a ggplot time series of time on the xaxis cases on the y, colour by data type</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> value, <span class="at">col=</span>var_name)) <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span>  <span class="co">#add line style</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># add points to the line</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Malaria Indicators Cases in:"</span>, input<span class="sc">$</span>province_select), <span class="co"># add selected province to the title and change name</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Confirmed Cases"</span>, </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"Indicator"</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"malaria_cases"</span> <span class="ot">=</span> <span class="st">"#571845"</span>, <span class="st">"malaria_tests"</span> <span class="ot">=</span> <span class="st">"#C42847"</span>))<span class="sc">+</span> <span class="co"># set the colour values</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>()</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Convert ggplot to interactive Plotly object</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplotly</span>(p)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/first-plot-card-input-select.PNG" class="img-fluid"></p>
</div>
</div>
</div>
</section>
</section>
<section id="end-of-part-2-what-youve-built-so-far" class="level2">
<h2 class="anchored" data-anchor-id="end-of-part-2-what-youve-built-so-far">End of Part 2 ‚Äî What You‚Äôve Built So Far</h2>
<p>‚úÖ You now have a fully <strong>reactive dashboard skeleton</strong>:</p>
<ul>
<li><p><strong>Inputs</strong>: User selects a Province and which data series to view.</p></li>
<li><p><strong>Reactive filtering</strong>: The app filters the dataset automatically.</p></li>
<li><p><strong>Outputs</strong>:</p>
<ul>
<li><p>Value boxes update in real-time</p></li>
<li><p>Interactive time series plots update dynamically</p></li>
<li><p>You‚Äôve seen how both text-based and graphical outputs follow the same reactivity pattern.</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="part-3-evolving-features---making-our-app-better" class="level1">
<h1>Part 3: Evolving Features - Making Our App Better!</h1>
<p>Now that we‚Äôve built the basic functionality of our dashboard, let‚Äôs improve the <strong>user experience</strong>, visual polish and ensure that all cards and value boxes contain useful information to the end-user.</p>
<p>Firstly here are small enhancements that go a long way in making your app more intuitive, accessible, and navigable for the user.</p>
<section id="adding-messages-and-prompts" class="level2">
<h2 class="anchored" data-anchor-id="adding-messages-and-prompts">Adding messages and prompts üìß</h2>
<p>When we first launch the app, the dashboard appears blank until a user selects a Province and at least one data series. While this is expected, it might not be intuitive for users who are unfamiliar with how the app works.</p>
<p>To improve the user experience, we can <strong>add helpful messages</strong> that appear when required inputs are missing. This kind of feedback, often referred to as <strong>conditional UI messaging</strong>, helps guide users through the app and ensures they understand what to do next.</p>
<p>We‚Äôll use the <code>validate()</code> and <code>need()</code> functions from Shiny to conditionally display informative prompts <em>in place of a plot</em> until the required input is provided.</p>
<p>To do this we can add the following code to the top of all of our server code for value boxes add:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># condiditional messaging -  Check if province selection is made and if not display the following message </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">validate</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">need</span>(input<span class="sc">$</span>province_select <span class="sc">!=</span> <span class="st">""</span>, <span class="st">"Select a province"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To the plot server code add the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># condiditional messaging -  Check if province selection is made and if not display the following message </span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if data selected and prompt to select data series</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">validate</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">need</span>(input<span class="sc">$</span>province_select <span class="sc">!=</span> <span class="st">""</span>, <span class="st">"Please select a province to view data."</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">need</span>(<span class="fu">length</span>(input<span class="sc">$</span>series_select) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"Please select at least one data elemtent to generate the plot."</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>What This Does:</strong></p>
<ul>
<li><p><strong><code>validate()</code></strong> Tells Shiny to check conditions before rendering output</p></li>
<li><p><strong><code>need()</code></strong> Provides a custom message that is shown in the output space when a condition isn‚Äôt met.</p></li>
<li><p>These messages appear in the <strong>same area where the plot would go</strong>, giving users immediate, contextual guidance.</p></li>
</ul>
<p><img src="images/condiditional-message.PNG" class="img-fluid"></p>
</section>
<section id="adding-a-short-description-of-the-application" class="level2">
<h2 class="anchored" data-anchor-id="adding-a-short-description-of-the-application">Adding a Short Description of the Application üñäÔ∏è</h2>
<p>As we continue to improve the user experience, it‚Äôs helpful to provide some <strong>context or instructions</strong> directly in the app. One simple but effective enhancement is adding a short <strong>descriptive text</strong> at the top of the sidebar panel and a Title to the main plot output.</p>
<p>This gives users a quick overview of what the tool does, what the inputs mean, or what they should expect to see - without needing to refer to an external guide.</p>
<section id="exercise-8" class="level3">
<h3 class="anchored" data-anchor-id="exercise-8">Exercise 8</h3>
<ol start="8" type="1">
<li>In your <code>ui</code> replace the <code>p("User Inputs")</code> with a more informative description. And add a main title to replace <code>"Main contents"</code> . <strong>Hint</strong> use the function <code>h1(" ")</code> to add your title as this will give it a Header level 1 style.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Show Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-sidebar---------</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    sidebar <span class="ot">=</span> <span class="fu">sidebar</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>      <span class="co"># informative title</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>(<span class="st">"Dashboard for examining province level malaria indicators in Laos.</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="st">         Select a province and data series to view the trends over time."</span>),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Province selection </span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"province_select"</span>,  <span class="co"># ID value</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Select a Province:"</span>, <span class="co"># UI side Title</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="fu">sort</span>(<span class="fu">unique</span>(app_data<span class="sc">$</span>organisation_unit))), <span class="co"># empty first value followed by all of our unique org_unit names</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected =</span> <span class="st">""</span> <span class="co"># default value that the application starts with as selected - in our case we want this to be blank. </span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Data series toggle </span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">checkboxGroupInput</span>(</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"series_select"</span>, <span class="co"># give usable ID</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Select data series:"</span>, <span class="co"># UI side title</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"Confirmed Cases"</span> <span class="ot">=</span> <span class="st">"malaria_cases"</span>, <span class="co"># filter variables with nice formatting for the UI</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Malaria Tests"</span>  <span class="ot">=</span> <span class="st">"malaria_tests"</span>),</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected =</span> <span class="cn">NULL</span> <span class="co">#ensure selection is empty initially</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-main pannel content----</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">h1</span>(<span class="st">"Malaria Indicators Dashboard"</span>), <span class="co"># Main title of the app</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>What This Does:</strong></p>
<ul>
<li><p>The <code>p()</code> function inserts a paragraph of plain text at the top of the sidebar.</p></li>
<li><p>This lightweight description gives users quick context about what they‚Äôre seeing and how to interact with the app.</p></li>
</ul>
<p><img src="images/title-and-desc.PNG" class="img-fluid"></p>
</div>
</div>
</div>
<div class="callout-tip\">
<p>Keep this description short and scannable. If you want to include more detailed information (e.g., methodology or indicator definitions), we could use a <a href="https://rstudio.github.io/bslib/reference/accordion.html">collapsible help text</a>, a <a href="https://shiny.posit.co/r/reference/shiny/1.6.0/modaldialog.html">modal popup</a>, or a <a href="https://shiny.posit.co/r/layouts/tabs/">separate ‚ÄúAbout‚Äù tab</a> - we‚Äôll suggest some resources for this later in the tutorial.</p>
</div>
</section>
</section>
<section id="theming-with-bs_theme" class="level2">
<h2 class="anchored" data-anchor-id="theming-with-bs_theme">Theming with <code>bs_theme</code> üé®</h2>
<p>Until now, our dashboard has been using the <strong>default Shiny style:</strong> functional,but plain and we added colour values to our <code>value_box</code>. We can now take advantage of the <a href="https://rstudio.github.io/bslib/"><code>bslib</code></a> package to apply <strong>modern, responsive theming</strong> with just a few lines of code (via <a href="https://bootswatch.com/default/">bootswatch</a>).</p>
<p>Applying a theme makes your app easier to use, improves readability, and gives it a more professional look - especially useful when sharing with stakeholders or integrating into your organization‚Äôs brand.</p>
<p>We can tell our app directly to use a built-in theme in the <code>UI</code> code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-Define UI for application - User Interface------------------------------------</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">page_fluid</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#-layout------------------------</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_sidebar</span>(</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-sidebar---------</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sidebar =</span> <span class="fu">sidebar</span>(</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>      <span class="co"># informative title</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>(<span class="st">"Dashboard for examining province level malaria indicators in Laos.</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="st">         Select a province and data series to view the trends over time."</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Province selection </span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"province_select"</span>,  <span class="co"># ID value</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Select a Province:"</span>, <span class="co"># UI side Title</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="fu">sort</span>(<span class="fu">unique</span>(app_data<span class="sc">$</span>organisation_unit))), <span class="co"># empty first value followed by all of our unique org_unit names</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected =</span> <span class="st">""</span> <span class="co"># default value that the application starts with as selected - in our case we want this to be blank. </span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Data series toggle </span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">checkboxGroupInput</span>(</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"series_select"</span>, <span class="co"># give usable ID</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Select data series:"</span>, <span class="co"># UI side title</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"Confirmed Cases"</span> <span class="ot">=</span> <span class="st">"malaria_cases"</span>, <span class="co"># filter variables with nice formatting for the UI</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Malaria Tests"</span>  <span class="ot">=</span> <span class="st">"malaria_tests"</span>),</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected =</span> <span class="cn">NULL</span> <span class="co">#ensure selection is empty initially</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-main pannel content----</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">h1</span>(<span class="st">"Malaria Indicators Dashboard"</span>), <span class="co"># Main title of the app</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Value Boxes in a single row that wraps responsive to screen size</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_column_wrap</span>( </span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Total Cases Reported"</span>,</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span>  <span class="fu">textOutput</span>(<span class="st">"total_cases_box"</span>), <span class="co"># reactive value taken from server side outputs</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"journal-medical"</span>),</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"pink"</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Total Tests Reported"</span>, </span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="fu">textOutput</span>(<span class="st">"total_tests_box"</span>), <span class="co">#render output call</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"journal-medical"</span>), <span class="co"># update icon</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"blue"</span> </span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>      <span class="co"># addiditional boxes</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>      <span class="co"># value_box(title = "Value box 3", value = 123), </span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># value_box(title = "Value box 4", value = 456), </span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>      <span class="co"># value_box(title = "Value box 5", value = 789), </span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>      <span class="co"># value_box(title = "Value box 6", value = 101112)</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cards in a single row</span></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>(</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">height=</span><span class="dv">400</span>, </span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Monthly Malaria Indicators"</span>),    <span class="co"># informative card header</span></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="fu">plotlyOutput</span>(<span class="st">"ts_plot"</span>)),      <span class="co"># include plotlyOutput in the card body and name this output ts_plot</span></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Data source: DHIS2 export"</span>) <span class="co">#informative card footer</span></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">200</span>, </span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Another Header"</span>), </span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="st">"Another Card"</span>), </span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Another Footer"</span>)</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># &lt;&lt;&lt; NEW &gt;&gt;&gt; Defining the theme of your app </span></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">bs_theme</span>(</span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">version =</span> <span class="dv">5</span>,                       <span class="co"># Use Bootstrap 5</span></span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">bootswatch =</span> <span class="st">"darkly"</span>,             <span class="co"># Choose a Bootswatch theme</span></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_font =</span> <span class="fu">font_google</span>(<span class="st">"Roboto"</span>)  <span class="co"># Optional: use a modern font</span></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/theme-change.PNG" class="img-fluid"></p>
<section id="exercise-9" class="level3">
<h3 class="anchored" data-anchor-id="exercise-9">Exercise 9</h3>
<ol start="9" type="1">
<li>Try replacing <code>"darkly"</code> with other <a href="https://bootswatch.com/">Bootswatch themes</a> like <code>"cosmo"</code>, <code>"journal"</code>, <code>"sandstone"</code>, <code>"minty"</code>, or <code>"cybord"</code> or select from the webpage linked.</li>
</ol>
<p>You can also try out styles <strong>live inside your app</strong> using <code>bs_themer()</code>. To use it, just call <code>bs_themer()</code> once inside your <code>server()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bs_themer</span>()</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The rest of our code ... </span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/theme-customiser.PNG" class="img-fluid"></p>
<p>As well as experimenting with pre-built themes you can also customise your own theming using the <code>bs_themer</code> for example if I played around in the theming and decided I wanted to use some colours similar to the AMMnet branding I could do this and then in my R console <code>bs_themer</code> lets us know what we changed and then we can add this to our <code>theme = bs_theme()</code> call. This is really helpful for playing with branding of your app to match with your organisations branding.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a> theme <span class="ot">=</span> <span class="fu">bs_theme</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">version =</span> <span class="dv">5</span>, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">fg =</span> <span class="st">"rgb(100, 16, 59)"</span>,   <span class="co"># set the foreground colour</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">bg =</span> <span class="st">"rgb(253, 251, 252)"</span>, <span class="co"># set the background colour </span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">primary =</span> <span class="st">"#7C204F"</span>,       <span class="co"># set the primary colour </span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">secondary =</span> <span class="st">"#F7CBE6"</span>      <span class="co"># set the secondary colour</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Don‚Äôt forget</strong> to remove <code>bs_themer()</code> from the <code>server()</code> once you‚Äôre done ‚Äî it‚Äôs just for development.</p>
</div>
</div>
<p>To give users the opportunity to pick between a light or dark mode of your dashboard too you can simply implement the following in the <code>ui</code></p>
<p>Here we place it after the description in the sidebar but you can place it anywhere in the UI and set the default to start the app in light mode.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add dark/light switch </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">input_dark_mode</span>(<span class="at">mode=</span><span class="st">"light"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/light-model.PNG" class="img-fluid"></p>
<p><img src="images/dark-model.PNG" class="img-fluid"></p>
<p>Now we have developed a theme we have another option for how to set the theme arguement for our value boxes. To ensure that when we change the theme of our app our value boxes automatically align with that theme we can set the theme arguement to be <code>"primary"</code> or ‚Äú<code>secondary"</code> and the boxes will inherit the colour values of the themes primary and secondary colours - let‚Äôs add this now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Value Boxes in a single row that wraps responsive to screen size</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_column_wrap</span>( </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Total Cases Reported"</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span>  <span class="fu">textOutput</span>(<span class="st">"total_cases_box"</span>), <span class="co"># reactive value taken from server side outputs</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"journal-medical"</span>),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"secondary"</span> <span class="co"># app theme colour secondary</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Total Tests Reported"</span>, </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="fu">textOutput</span>(<span class="st">"total_tests_box"</span>), <span class="co">#render output call</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"journal-medical"</span>), <span class="co"># update icon</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"secondary"</span> <span class="co">#app theme colour secondary</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>      <span class="co"># addiditional boxes</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># value_box(title = "Value box 3", value = 123), </span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># value_box(title = "Value box 4", value = 456), </span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>      <span class="co"># value_box(title = "Value box 5", value = 789), </span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># value_box(title = "Value box 6", value = 101112)</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/value-box-secondary-theme.PNG" class="img-fluid"></p>
</section>
<section id="exercise-10" class="level3">
<h3 class="anchored" data-anchor-id="exercise-10">Exercise 10</h3>
<ol start="10" type="1">
<li>Now you have the value boxes set to inherit theme colours test out some more themes are render your app to see how these automatically change. <strong>Hint:</strong> try setting each value box theme to a different value.</li>
</ol>
</section>
</section>
<section id="adding-a-logo-to-your-app" class="level2">
<h2 class="anchored" data-anchor-id="adding-a-logo-to-your-app">Adding a Logo to Your App</h2>
<p>Once you‚Äôve customized the colors and fonts, finish off your look by <strong>adding a logo</strong> (or icon/banner) to the top of your <code>sidebar = sidebar()</code> code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-sidebar---------</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>sidebar <span class="ot">=</span> <span class="fu">sidebar</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a logo </span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> <span class="st">"AMMnet-logo.png"</span>), <span class="co"># make sure this image exists in a folder called www </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then do the following:</p>
<p>Folder Setup</p>
<ul>
<li><p>Create a <code>www/</code> folder in your app directory if it doesn‚Äôt exist.</p></li>
<li><p>Save your logo or image as <code>logo.png</code> (or any name but it must match what you coded up).</p></li>
<li><p>Shiny will automatically read image files from that folder.</p></li>
</ul>
<p><img src="images/logo.PNG" class="img-fluid"></p>
<section id="exercise-11" class="level3">
<h3 class="anchored" data-anchor-id="exercise-11">Exercise 11</h3>
<ol start="11" type="1">
<li>Find a logo online (e.g., your org, a flag, or malaria-related symbol or an image of your pet). Create and save it to your app‚Äôs <code>www/</code> folder. Add it to the sidebar using <code>tags$img()</code>.</li>
</ol>
</section>
</section>
<section id="wrapping-up-part-3-building-for-the-user" class="level2">
<h2 class="anchored" data-anchor-id="wrapping-up-part-3-building-for-the-user">Wrapping up Part 3 ‚Äî Building for the User</h2>
<p>In Part 3, we made your app feel more professional and intuitive for end users:</p>
<ul>
<li><p>Added <strong>validation messages</strong> to guide users when inputs are missing.</p></li>
<li><p>Included <strong>descriptive text</strong> in your sidebar and main title.</p></li>
<li><p>Applied a <strong>customizable visual theme</strong> with <code>{bslib}</code>.</p></li>
<li><p>Enhanced <strong>branding</strong> by adding a logo.</p></li>
<li><p>Made sure your <strong>value boxes inherit theme colors</strong> automatically.</p></li>
</ul>
<p>These are small details ‚Äî but they make your app feel polished, intentional, and ready to share with end users.</p>
</section>
</section>
<section id="part-4-addiditional-outputs" class="level1">
<h1>Part 4: Addiditional Outputs</h1>
<p>Now that we‚Äôve built a simple reactive and styled our app, let‚Äôs level up by introducing <strong>addiditional output types</strong> - we can convey more information than what we have currentlly presented in our app by adding more outputs.</p>
<p>A reminder that Shiny supports a wide range of different output types</p>
<p><img src="images/shiny-output-types.PNG" class="img-fluid"></p>
<p>We‚Äôll walk through some different examples of outputs how we can control their appearance/dissapearance in the app.</p>
<section id="computed-variables-and-conditional-widgets" class="level2">
<h2 class="anchored" data-anchor-id="computed-variables-and-conditional-widgets">Computed Variables and Conditional Widgets</h2>
<p>One of the powerful benefits of building dashboards in R is that we can compute new indicators directly inside our Shiny app using the data already loaded.</p>
<p>Let‚Äôs take <strong>Test Positivity Rate (TPR)</strong> as an example. This isn‚Äôt directly stored in our dataset but can easily be computed:</p>
<blockquote class="blockquote">
<p><strong>TPR = Confirmed Cases / Malaria Tests</strong></p>
</blockquote>
<p>We will create this as a computed reactive output, and allow the user to <strong>toggle</strong> whether they want to view this indicator.</p>
<p>This approach is helpful in malaria dashboards where:</p>
<ul>
<li><p>Some indicators are derived</p></li>
<li><p>Users may want optional, on-demand metrics</p></li>
<li><p>You want to avoid recalculating unnecessary metrics until they are requested</p></li>
</ul>
<p>Let‚Äôs start by giving the user a checkbox to control whether to calculate and display TPR:</p>
<p>Below our current data series selection include a new Input:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#-sidebar---------</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    sidebar <span class="ot">=</span> <span class="fu">sidebar</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add a logo </span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> <span class="st">"AMMnet-logo.png"</span>), <span class="co"># make sure this image exists in a folder called www </span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># informative title</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>(<span class="st">"Dashboard for examining province level malaria indicators in Laos.</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="st">         Select a province and data series to view the trends over time."</span>),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add dark/light switch </span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">input_dark_mode</span>(<span class="at">mode=</span><span class="st">"light"</span>),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Province selection </span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"province_select"</span>,  <span class="co"># ID value</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Select a Province:"</span>, <span class="co"># UI side Title</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="fu">sort</span>(<span class="fu">unique</span>(app_data<span class="sc">$</span>organisation_unit))), <span class="co"># empty first value followed by all of our unique org_unit names</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected =</span> <span class="st">""</span> <span class="co"># default value that the application starts with as selected - in our case we want this to be blank. </span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Data series toggle </span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">checkboxGroupInput</span>(</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"series_select"</span>, <span class="co"># give usable ID</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Select data series:"</span>, <span class="co"># UI side title</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"Confirmed Cases"</span> <span class="ot">=</span> <span class="st">"malaria_cases"</span>, <span class="co"># filter variables with nice formatting for the UI</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Malaria Tests"</span>  <span class="ot">=</span> <span class="st">"malaria_tests"</span>),</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">selected =</span> <span class="cn">NULL</span> <span class="co">#ensure selection is empty initially</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Test Positivity toggle </span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">checkboxInput</span>(</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"include_tpr"</span>, <span class="co"># name ID</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Calculate and diaplay Test Positivity Rate (TPR)"</span>, <span class="co"># User side title</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="cn">FALSE</span> <span class="co"># set to be unclicked as default</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However ‚Äî we only want this checkbox to be available when both <code>malaria_cases</code> and <code>malaria_tests</code> are selected for plotting. Otherwise, calculating TPR doesn‚Äôt make sense.</p>
<p>Shiny allows us to <strong>dynamically render UI elements</strong> using <code>renderUI()</code>. We‚Äôll modify our sidebar to only display the TPR toggle when both series are selected. Replace the code in the <code>ui</code> with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;&lt;&lt; Replace static checkbox with this dynamic output using the uiOutput() call</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">uiOutput</span>(<span class="st">"tpr_checkbox_ui"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then add this logic to your <code>server()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-Conditional UI element for TPR checkbox------------------------------------------------------</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>tpr_checkbox_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"malaria_cases"</span>, <span class="st">"malaria_tests"</span>) <span class="sc">%in%</span> input<span class="sc">$</span>series_select)) {</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Only show the checkbox if both series are selected</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">checkboxInput</span>(</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">inputId =</span> <span class="st">"include_tpr"</span>, <span class="co"># name ID</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Calculate and diaplay Test Positivity Rate (TPR)"</span>, <span class="co"># User side title</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="cn">FALSE</span> <span class="co"># set to be unclicked as default</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>      <span class="co"># If not both series selected, return NULL to not display the checkbox</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="images/conditioanl-check2.PNG" class="img-fluid"></p>
</div><div class="column" style="width:50%;">
<p><img src="images/condititional-checkbox.PNG" class="img-fluid"></p>
</div>
</div>
<p>Once the toggle exists, we can build a reactive plot that only displays if:</p>
<ul>
<li><p>A province is selected</p></li>
<li><p>Both indicators are selected</p></li>
<li><p>The TPR checkbox is enabled</p></li>
</ul>
<p>Inside the UI element update the empty card with the following logic:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Cards in a single row</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">height=</span><span class="dv">400</span>, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Monthly Malaria Indicators"</span>),<span class="co"># informative card header</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="fu">plotlyOutput</span>(<span class="st">"ts_plot"</span>)),       <span class="co"># include plotlyOutput in the card body and name this output ts_plot</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Data source: DHIS2 export"</span>)  <span class="co">#informative card footer</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">400</span>,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>,  </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Monthly Malaria Test Positivity"</span>), <span class="co"># informative card header</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="fu">plotlyOutput</span>(<span class="st">"tpr_plot"</span>)), <span class="co"># include plotlyOutput in the card body and name this output tpr_plot</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Data source: DHIS2 export"</span>) <span class="co"># informative card footer</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>      <span class="er">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Inside your <code>server()</code> function we can add new plot code along with some addiditional prompts to the user:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-Conditional rendering of TPR plot------------------------------------------------------------</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>tpr_plot <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use validate + need to provide informative user messages</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">validate</span>(</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">need</span>(input<span class="sc">$</span>include_tpr, <span class="st">"Enable TPR toggle to display plot."</span>),</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">need</span>(input<span class="sc">$</span>province_select <span class="sc">!=</span> <span class="st">""</span>, <span class="st">"Please select a province to view data."</span>),</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">need</span>(<span class="fu">length</span>(input<span class="sc">$</span>series_select) <span class="sc">==</span> <span class="dv">2</span>, <span class="st">"Please select both malaria cases and malaria tests to calculate TPR."</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate TPR - Test Positivity Rate</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">province_data</span>() <span class="sc">%&gt;%</span> <span class="co"># get the filtered province data</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> var_name, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> <span class="co"># pivot the data wider to have cases and tests in separate columns</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(period) <span class="sc">%&gt;%</span> <span class="co"># arrange by period</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">tpr =</span> <span class="fu">round</span>((malaria_cases <span class="sc">/</span> malaria_tests) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>) <span class="co"># calculate TPR as a percentage - rounded to 2 decimal places</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the TPR over time</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> </span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> tpr)) <span class="sc">+</span> </span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#FECC01"</span>) <span class="sc">+</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Test Positivity Rate (TPR) in:"</span>, input<span class="sc">$</span>province_select), <span class="co"># add selected province to the title</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"TPR (%)"</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="co"># set y-axis limits from 0 to 100%</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplotly</span>(p) <span class="co"># convert ggplot to plotly object</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/conditional-tpr-1.PNG" class="img-fluid"></p>
<p>Once a user safely selects all of the inputs a plot will generate.</p>
<ul>
<li><p><code>validate()</code> + <code>need()</code> provide friendly user-facing error messages inside the plot container.</p></li>
<li><p>Only once all conditions are met, the plot is rendered.</p></li>
<li><p>This is much more user-friendly than simply leaving the plot blank or throwing errors!</p></li>
</ul>
<p><img src="images/tpr-plot-card-1.PNG" class="img-fluid"></p>
<section id="exrecise-12" class="level3">
<h3 class="anchored" data-anchor-id="exrecise-12">Exrecise 12</h3>
<p>Now let‚Äôs reinforce your learning with a short coding challenge:</p>
<ol start="12" type="1">
<li>Create a new <strong>value box</strong> that displays the <em>average TPR for the year</em>, but only when the checkbox <code>include_tpr</code> is turned on.</li>
</ol>
<p><strong>Your logic should:</strong></p>
<ul>
<li>Calculate the TPR inside the server (same as you did for the other value boxes) but use <code>sumarise(tpr = mean(tpr, na.rm = TRUE)</code> to take the average value.</li>
<li>Conditionally display the value box only when the checkbox <code>include_tpr</code> is TRUE</li>
<li>Keep using <code>province_data()</code> for your data filtering</li>
<li>You can use <code>renderUI()</code> to conditionally create the value box.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Show Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Compute average TPR: Add this to your <code>server()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#-average TPR value box-----------------------------------------------------------------</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>tpr_value <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>include_tpr) <span class="co"># requires the TPR check to be TRUE </span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># data processing</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">province_data</span>() <span class="sc">%&gt;%</span> <span class="co"># filters to province</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> var_name, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> <span class="co">#widens data frame to have a column per indicator </span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">tpr =</span> <span class="fu">round</span>((malaria_cases <span class="sc">/</span> malaria_tests) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>) <span class="co"># calculates TPR as a percentage</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">tpr =</span> <span class="fu">mean</span>(tpr, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="co"># takes average of TPR on % scale </span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>        ) </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    avg_tpr <span class="ot">&lt;-</span> <span class="fu">round</span>(df<span class="sc">$</span>tpr, <span class="dv">1</span>) <span class="co"># rounds to one decimal place</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    avg_tpr <span class="co"># returns value </span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Update UI code to include <img src="images/conditional-value-box.PNG" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout_column_wrap</span>( </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Total Cases Reported"</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span>  <span class="fu">textOutput</span>(<span class="st">"total_cases_box"</span>), <span class="co"># reactive value taken from server side outputs</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"journal-medical"</span>),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"secondary"</span> <span class="co"># app theme colour secondary</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Total Tests Reported"</span>, </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="fu">textOutput</span>(<span class="st">"total_tests_box"</span>), <span class="co">#render output call</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"journal-medical"</span>), <span class="co"># update icon</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"secondary"</span> <span class="co">#app theme colour secondary</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>      <span class="co">#conditional value box for TPR</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"tpr_value_box"</span>) <span class="co"># this is a reactive value box that will only show if the TPR checkbox is selected</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tell the server what to place in ‚Äútpr_value‚Äù</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-Render the value box for TPR if checkbox is selected---------------------------------------------</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>tpr_value_box <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if the TPR checkbox is selected</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(input<span class="sc">$</span>include_tpr))  { <span class="co"># requires TPR check to be active</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># standard value box set up </span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">value_box</span>(</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Average TPR (%)"</span>,       <span class="co"># Title</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="fu">textOutput</span>(<span class="st">"tpr_value"</span>), <span class="co"># using condiditional value </span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"percent"</span>), <span class="co">#Icon</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase_layout =</span> <span class="st">"top right"</span>,   <span class="co"># placement</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">theme =</span> <span class="st">"secondary"</span>              <span class="co"># colour theme</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span> <span class="co"># if not checked then nothing is displayed</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/conditional-value-box.PNG" class="img-fluid"></p>
</div>
</div>
</div>
<p>You may notice here that our app has a blank space where the Test Positivity values are expected to be which doesn‚Äôt look very professional.</p>
<p>To prevent the empty placeholder space when the toggle is off, we can <strong>dynamically generate</strong> the entire set of value boxes using <code>renderUI()</code>.</p>
<p>Instead of placing <code>uiOutput("tpr_value_box")</code> inside your existing <code>layout_column_wrap()</code>, we will let the server fully control which value boxes appear at any moment.</p>
<p>First we replace the current <code>ui</code> code for our value boxes with the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Value Boxes in a single row that wraps responsive to screen size and data selection</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">uiOutput</span>(<span class="st">"value_boxes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then link the <code>value_boxes</code> to a server side output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-Value Box dynamic number based on TPR toggle-----------------------------------------------------</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>value_boxes <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Always include these two</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  boxes <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">value_box</span>(</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Total Cases Reported"</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="fu">textOutput</span>(<span class="st">"total_cases_box"</span>),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"journal-medical"</span>),</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">theme =</span> <span class="st">"secondary"</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">value_box</span>(</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Total Tests Reported"</span>, </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="fu">textOutput</span>(<span class="st">"total_tests_box"</span>),</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"journal-medical"</span>), </span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">showcase_layout =</span> <span class="st">"top right"</span>, </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">theme =</span> <span class="st">"secondary"</span> </span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Conditionally add TPR box only if checkbox is ON</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(input<span class="sc">$</span>include_tpr)) {</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>    boxes <span class="ot">&lt;-</span> <span class="fu">append</span>(boxes, <span class="fu">list</span>(</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">value_box</span>(</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Average TPR (%)"</span>,</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> <span class="fu">textOutput</span>(<span class="st">"tpr_value"</span>),</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase =</span> bsicons<span class="sc">::</span><span class="fu">bs_icon</span>(<span class="st">"percent"</span>),</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">showcase_layout =</span> <span class="st">"top right"</span>,</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">theme =</span> <span class="st">"secondary"</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wrap all boxes inside layout_column_wrap</span></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_column_wrap</span>(<span class="sc">!!!</span>boxes)</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>The <code>!!!</code> operator (from <code>rlang</code>) safely unpacks the list into multiple arguments for <code>layout_column_wrap()</code>. This allows us to dynamically build the list of value boxes.</p>
</blockquote>
<p><img src="images/vb-1.PNG" class="img-fluid"></p>
<p><img src="images/vb2.PNG" class="img-fluid"></p>
<p>Now your app will only show the TPR value box when appropriate ‚Äî without leaving any empty space when the toggle is off!</p>
<ul>
<li><p><code>renderUI()</code> gives you full control over when and how UI elements appear.</p></li>
<li><p>You avoid ‚Äúempty shells‚Äù by only adding UI objects when their underlying data exists.</p></li>
<li><p>The user experience is cleaner, avoids confusion, and reflects the actual available information.</p></li>
</ul>
</section>
</section>
<section id="input-selection-within-cards" class="level2">
<h2 class="anchored" data-anchor-id="input-selection-within-cards">Input Selection Within Cards</h2>
<p>Having the data series selection buttons in the sidebar when they control all of the plots on the dashbaord is okay but if we want to add addiditional plots a long list of selection boxes may be confusing for the user.</p>
<p>What we can do is build a card with a sidebar for selections <strong>directly</strong> within that card.</p>
<p>For the current plots of reported cases and tests and calculated TPR, lets create a single card with a sidebar within that card that directs the user for what data to select to display plots.</p>
<p>Replace our current two <code>card()</code> layout with the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Card with a sidebar for input selection </span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">height =</span> <span class="dv">500</span>, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># global card header</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_header</span>(<span class="st">"Monthyl Malaria Indicator Trends"</span>),</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># sidebar layout with sidebar and card body</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">layout_sidebar</span>(</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># add the sidebar with input elements</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">sidebar =</span> <span class="fu">list</span>(</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>          <span class="co"># include original data series checkboes</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">checkboxGroupInput</span>(</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">inputId  =</span> <span class="st">"series_select"</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">label    =</span> <span class="st">"Select data series:"</span>,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">choices  =</span> <span class="fu">c</span>(</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Confirmed Cases"</span> <span class="ot">=</span> <span class="st">"malaria_cases"</span>,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Malaria Tests"</span>   <span class="ot">=</span> <span class="st">"malaria_tests"</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>          ),</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>          <span class="co"># condiditionally render TPR checkbox</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>          <span class="fu">uiOutput</span>(<span class="st">"tpr_checkbox_ui"</span>)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># include the card body with the plots</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>          <span class="co"># wrap the calls into a column layout</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>          <span class="fu">layout_column_wrap</span>(</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>            <span class="fu">plotlyOutput</span>(<span class="st">"ts_plot"</span>),</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">plotlyOutput</span>(<span class="st">"tpr_plot"</span>)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Data source: DHIS2 export"</span>) <span class="co"># informative card footer</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And <strong>REMOVE</strong> the data series selection and TPR selection from the sidebar code - keep it only in our new card.</p>
<p><img src="images/card-sidebar.PNG" class="img-fluid"></p>
<p>This functionality would be nicer if first plot could take up the full width of the card when the TPR box is not checked - we can acheive this by making the following changes:</p>
<p>Instead of hard-coding the layout inside <code>card_body()</code> we can replace it with a dynamic UI placeholder:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Card with a sidebar for input selection </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>      <span class="co"># global card header</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_header</span>(<span class="st">"Monthyl Malaria Indicator Trends"</span>),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>      <span class="co"># sidebar layout with sidebar and card body</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">layout_sidebar</span>(</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># add the sidebar with input elements</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">sidebar =</span> <span class="fu">list</span>(</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>          <span class="co"># include original data series checkboes</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">checkboxGroupInput</span>(</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">inputId  =</span> <span class="st">"series_select"</span>,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">label    =</span> <span class="st">"Select data series:"</span>,</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">choices  =</span> <span class="fu">c</span>(</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Confirmed Cases"</span> <span class="ot">=</span> <span class="st">"malaria_cases"</span>,</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Malaria Tests"</span>   <span class="ot">=</span> <span class="st">"malaria_tests"</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>          ),</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>          <span class="co"># condiditionally render TPR checkbox</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>          <span class="fu">uiOutput</span>(<span class="st">"tpr_checkbox_ui"</span>)</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># include the card body with the plots</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>          <span class="co"># UI output that will dynamically render different layout</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">uiOutput</span>(<span class="st">"ts_plots_ui"</span>)</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Data source: DHIS2 export"</span>) <span class="co"># informative card footer</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And then we can update the server code to conditionally layout the plots based on whether the TPR checkbox is selected or not:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-conditional layout for time series plots---------------------------------------------</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>ts_plots_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If TPR is selected, show both plots side by side</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(input<span class="sc">$</span>include_tpr)) { </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show both plots side by side</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>(</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">col_widths =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">6</span>),  <span class="co"># 50-50 width</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotlyOutput</span>(<span class="st">"ts_plot"</span>),</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotlyOutput</span>(<span class="st">"tpr_plot"</span>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If TPR is not selected, show only the main time series plot</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show single plot full width</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>(</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">col_widths =</span> <span class="fu">c</span>(<span class="dv">12</span>),  <span class="co"># full width</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotlyOutput</span>(<span class="st">"ts_plot"</span>)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/short-card.PNG" class="img-fluid"></p>
<section id="stretch-exercise" class="level3">
<h3 class="anchored" data-anchor-id="stretch-exercise">Stretch Exercise</h3>
<p>üéØ Your Task - add a new card panel below the current plots showing a time series plot of incidence per 1,000 people in the selected province.</p>
<p>This plot will:</p>
<ul>
<li><p>Use data where <code>var_name == "malaria_cases_per_1000"</code></p></li>
<li><p>Show a single line plot with one point per month</p></li>
<li><p>Appear in a new <code>card()</code> component with a header and footer</p></li>
<li><p>Only display when a province <code>input$province_select</code> is selected, prior to showing a plot display a helpful message to let users know to select a province</p></li>
<li><p>Use <code>renderPlotly()</code> to make it interactive</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Show Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Add a new card to the UI</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># incidence plot card </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">height =</span> <span class="dv">400</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">full_screen =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_header</span>(<span class="st">"Monthyl Malaria Incidence Trends"</span>), <span class="co"># card header</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_body</span>(<span class="fu">plotlyOutput</span>(<span class="st">"inc_plot"</span>)),     <span class="co"># plotly output for the incidence plot</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_footer</span>(<span class="st">"Data source: DHIS2 export"</span>) <span class="co"># informative card footer</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Add plot code to the server</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>inc_plot <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add messages to inform user to select a province</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">validate</span>(</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">need</span>(input<span class="sc">$</span>province_select <span class="sc">!=</span> <span class="st">""</span>, <span class="st">"Please select a province to view data."</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter dataset</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">province_data</span>() <span class="sc">%&gt;%</span> <span class="co"># filtr ptovince data</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(var_name <span class="sc">==</span> <span class="st">"malaria_cases_per_1000"</span>) <span class="co"># select inc var</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure there is data to plot</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">validate</span>(</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">need</span>(<span class="fu">nrow</span>(df) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"No incidence data available for this province."</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the incidence over time </span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> </span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#FECC01"</span>) <span class="sc">+</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#FECC01"</span>) <span class="sc">+</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Malaria Incidence in:"</span>, input<span class="sc">$</span>province_select),</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Incidence (per 1,000)"</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplotly</span>(p)</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/incidence.PNG" class="img-fluid"></p>
</div>
</div>
</div>
</section>
</section>
<section id="including-leaflet-maps" class="level2">
<h2 class="anchored" data-anchor-id="including-leaflet-maps">Including Leaflet Maps</h2>
<p>Now that your dashboard includes time series and summary statistics, let‚Äôs add a <strong>spatial view</strong> using an interactive map. This will help users visually explore <strong>malaria burden across provinces</strong>.</p>
<p>We‚Äôll use the <code>{leaflet}</code> package to create a <strong>map</strong> of average annual incidence per 1,000 people, and we‚Äôll highlight the <strong>selected province</strong> from the sidebar dropdown.</p>
<p>Think of leaflet as allowing us to use a google maps style map to our dashboard rather than a static image.</p>
<p>We will build an interactive <strong>leaflet map</strong> that:</p>
<ul>
<li><p>Fills each province with a color based on <strong>average annual incidence</strong></p></li>
<li><p>Adds a <strong>legend</strong> for the color scale</p></li>
<li><p><strong>Highlights the selected province</strong> with a bold outline</p></li>
<li><p>Shows <strong>tooltips</strong> when hovering over provinces</p></li>
</ul>
<p>For plotting maps we need to ensure we have a shapefile at the correct administrative boundary - download the file and add it to your <code>data-outputs</code> folder.</p>
<p><a href="data-outputs.zip" download="">Download data-outputs.zip</a></p>
<p>At the top of your app (after loading your libraries and data), add:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>adm1_shp <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"./data-outputs/adm1_shapefile.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Add a new column layout to ensure the map and the incidence plot fall on the same row of the dashboard and adjust the widths to allow more space for the line plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># incidence plot card - including map </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout_columns</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>      <span class="co"># width - adjust the width to give some more space to the line chart</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">col_widths =</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">5</span>), </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">400</span>,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>,</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Monthly Malaria Incidence Trends"</span>),</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="fu">plotlyOutput</span>(<span class="st">"inc_plot"</span>, <span class="at">height =</span> <span class="st">"350px"</span>)),</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Data source: DHIS2 export"</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card</span>(</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">400</span>,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">full_screen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_header</span>(<span class="st">"Average Annual Incidence Map"</span>),</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_body</span>(<span class="fu">leafletOutput</span>(<span class="st">"inc_map"</span>, <span class="at">height =</span> <span class="st">"350px"</span>)),</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">card_footer</span>(<span class="st">"Data source: HumData for shape files, DHIS2 for malaria data"</span>)</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now buid the Maps using Leaflet Syntax in the server. We add a highlight outline to the Province that the user has selected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Incidence leaflet map----------------------------------------------------------------------</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>inc_map <span class="ot">&lt;-</span> <span class="fu">renderLeaflet</span>({</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add messages to inform user to select a province</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">validate</span>(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">need</span>(input<span class="sc">$</span>province_select <span class="sc">!=</span> <span class="st">""</span>, <span class="st">"Please select a province to view data."</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summarise incidence by province - no need to use filtered data as </span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we want all provinces shown on the map</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    app_data <span class="sc">%&gt;%</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(var_name <span class="sc">==</span> <span class="st">"malaria_cases_per_1000"</span>) <span class="sc">%&gt;%</span> <span class="co"># filter to incidence data</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(organisation_unit) <span class="sc">%&gt;%</span>  <span class="co"># group by organisation unit</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">inc =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="co"># calculate mean incidence per 1,000</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join data to spatial file</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  df_shape <span class="ot">&lt;-</span> <span class="fu">left_join</span>(adm1_shp, df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"org_unit"</span> <span class="ot">=</span> <span class="st">"organisation_unit"</span>))</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create color palette </span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  pal <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"YlOrRd"</span>,</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">domain =</span> df_shape<span class="sc">$</span>inc, <span class="co"># use the incidence values for color mapping</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.color =</span> <span class="st">"#f0f0f0"</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the leaflet map </span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">leaflet</span>(df_shape) <span class="sc">%&gt;%</span> <span class="co"># use the spatial data</span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>CartoDB.Positron) <span class="sc">%&gt;%</span> <span class="co"># adds base map layer</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">addPolygons</span>( </span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add polygons for each province</span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">pal</span>(inc), <span class="co"># fill color based on incidence</span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">weight =</span> <span class="sc">~</span><span class="fu">ifelse</span>(org_unit <span class="sc">==</span> input<span class="sc">$</span>province_select, <span class="dv">3</span>, <span class="dv">1</span>), <span class="co"># highlight selected province with thicker border</span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="sc">~</span><span class="fu">ifelse</span>(org_unit <span class="sc">==</span> input<span class="sc">$</span>province_select, <span class="st">"#7C204F"</span>, <span class="st">"black"</span>), <span class="co"># set border color</span></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">opacity =</span> <span class="dv">1</span>, <span class="co"># set opacity of the border</span></span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">fillOpacity =</span> <span class="fl">0.8</span>, <span class="co"># set fill opacity </span></span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="sc">~</span><span class="fu">paste0</span>(org_unit, <span class="st">": "</span>, <span class="fu">round</span>(inc, <span class="dv">1</span>), <span class="st">" per 1,000"</span>), <span class="co"># add labels with province name and incidence</span></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">highlightOptions =</span> <span class="fu">highlightOptions</span>(</span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># highlight options for interactivity</span></span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">weight =</span> <span class="dv">3</span>, <span class="co"># thicker border on hover</span></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"#333"</span>, <span class="co"># darker border on hover</span></span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">fillOpacity =</span> <span class="fl">0.9</span>, <span class="co"># fill opacity on hover</span></span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">bringToFront =</span> <span class="cn">TRUE</span> <span class="co"># bring polygon to front on hover</span></span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the color legend</span></span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">addLegend</span>(</span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">pal =</span> pal,</span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> df_shape<span class="sc">$</span>inc,</span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Avg Incidence (per 1,000)"</span>,</span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="st">"bottomright"</span></span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/map-inc.PNG" class="img-fluid"></p>
<p>In the current app, your <code>leaflet()</code> map uses: <code>addProviderTiles(providers$CartoDB.Positron)</code></p>
<p>This adds a light, minimal background map. But what if you wanted to give users a different map style?</p>
<section id="exercise-13" class="level3">
<h3 class="anchored" data-anchor-id="exercise-13">Exercise 13</h3>
<ol start="13" type="1">
<li>Explore other available background tiles using the <code>leaflet::providers</code> object. You can see a full list by running this command in your R console: <code>leaflet::providers</code> Replace <code>CartoDB.Positron</code> with or another of your choice. <strong>Hint:</strong> You only need to replace the argument to <code>addProviderTiles()</code>. For example: <code>addProviderTiles(providers$Esri.WorldImagery)</code>
<ol start="13" type="1">
<li>Set the column widths to a new value so that the first incidnece plot takes up more of the row space than the map.</li>
</ol></li>
</ol>
</section>
</section>
<section id="adding-a-table-output" class="level2">
<h2 class="anchored" data-anchor-id="adding-a-table-output">Adding a Table Output</h2>
<p>In many dashboards, tables complement visualizations by providing users with detailed numeric outputs.</p>
<p>Shiny has great support for interactive tables using the <strong>DT</strong> package.</p>
<p>Let‚Äôs create a summary table that:</p>
<ul>
<li><p>Aggregates total cases, total tests, average TPR and average incidence by province and includes the number of months that data is reported for in the province</p></li>
<li><p>Highlights the currently selected province</p></li>
<li><p>Displays all provinces at once</p></li>
<li><p>Is interactive (sortable, searchable, paginated)</p></li>
</ul>
<p>We will use <code>renderDT()</code> inside the server and <code>DTOutput()</code> inside the UI to create this table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DT output </span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_header</span>(<span class="st">"Summary Table"</span>), <span class="co"># card header</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_body</span>(<span class="fu">DTOutput</span>(<span class="st">"summary_data"</span>)), <span class="co"># DT output </span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_footer</span>(<span class="st">"Aggregated Annual Values per Province"</span>) <span class="co"># card footer</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now add this code inside your server:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -Summary table of annual values-------------------------------------------------------------</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>summary_data <span class="ot">&lt;-</span> <span class="fu">renderDT</span>({</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add messages to inform user to select a province</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">validate</span>(</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">need</span>(input<span class="sc">$</span>province_select <span class="sc">!=</span> <span class="st">""</span>, <span class="st">"Please select a province to view data."</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter and summarise the app_data to create a summary table using all provinces </span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    app_data <span class="sc">%&gt;%</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter to relevant variables</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(var_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"malaria_cases"</span>, <span class="st">"malaria_tests"</span>, <span class="st">"malaria_cases_per_1000"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pivot the data to wide format</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_from =</span> var_name,</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_from =</span> value,</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Group by organisation unit (province)</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(organisation_unit) <span class="sc">%&gt;%</span> </span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate TPR and summarise the data</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">tpr =</span> <span class="fu">round</span>((malaria_cases <span class="sc">/</span> malaria_tests) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Summarise the data to get total cases, total tests, average TPR, and average incidence</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># And two new variables - reporting months for cases and tests</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_cases =</span> <span class="fu">sum</span>(malaria_cases, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_tests =</span> <span class="fu">sum</span>(malaria_tests, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_tpr =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tpr, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_inc =</span> <span class="fu">round</span>(<span class="fu">mean</span>(malaria_cases_per_1000, <span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">1</span>), </span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">reporting_months_cases =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(malaria_cases)),</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">reporting_months_tests =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(malaria_tests))</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rename columns for nice table headings</span></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">Province =</span> organisation_unit,</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Cases</span><span class="st">`</span> <span class="ot">=</span> total_cases,</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Tests</span><span class="st">`</span> <span class="ot">=</span> total_tests,</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Average TPR (%)</span><span class="st">`</span> <span class="ot">=</span> avg_tpr,</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Avg Incidence</span><span class="st">`</span> <span class="ot">=</span> avg_inc,</span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Case Reporting Months</span><span class="st">`</span> <span class="ot">=</span> reporting_months_cases,</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Test Reporting Months</span><span class="st">`</span> <span class="ot">=</span> reporting_months_tests</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Build DT object</span></span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">datatable</span>(</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>    df, <span class="co"># Create a datatable from the summarised data</span></span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">rownames =</span> <span class="cn">FALSE</span>,  <span class="co"># disable row names</span></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">pageLength =</span> <span class="dv">10</span>, <span class="co"># number of rows per page</span></span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">dom =</span> <span class="st">"tip"</span>,     <span class="co"># table controls</span></span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">autoWidth =</span> <span class="cn">TRUE</span> <span class="co"># auto width for columns</span></span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Highlight selected province</span></span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (input<span class="sc">$</span>province_select <span class="sc">!=</span> <span class="st">""</span>) {</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply row styling to highlight the selected province</span></span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>    selected <span class="ot">&lt;-</span> input<span class="sc">$</span>province_select </span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use formatStyle to apply bold font weight to the selected province row</span></span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>    dt <span class="ot">&lt;-</span> dt <span class="sc">%&gt;%</span></span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">formatStyle</span>(</span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Province"</span>,</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">target =</span> <span class="st">"row"</span>,</span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">fontWeight =</span> <span class="fu">styleEqual</span>(selected, <span class="st">"bold"</span>)</span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the datatable object</span></span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a>  dt</span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When you run your app, you now have a sortable, searchable summary table with all provinces. The currently selected province row is bolded too.</p>
<p><img src="images/table-out.PNG" class="img-fluid"></p>
<section id="exercise-14---tricky" class="level3">
<h3 class="anchored" data-anchor-id="exercise-14---tricky">Exercise 14 - Tricky</h3>
<ol start="14" type="1">
<li>Users may want to export the summary data to analyze offline, share with colleagues, or integrate into reports. <strong>Your Task:</strong> Add a <strong>Download CSV</strong> button that allows users to download the table displayed above.</li>
</ol>
<p><strong>Hints</strong><em>:</em></p>
<ul>
<li><p>In your <strong>UI</strong>, use <code>downloadButton()</code> to add a button to the card.</p></li>
<li><p>In your <strong>server</strong>, create a <code>downloadHandler()</code> to generate the CSV file.</p></li>
<li><p>You can put the button inside the same card as your table, e.g., just above <code>DTOutput()</code>.</p></li>
<li><p>For downloading logic first check out the <code>downloadHandler</code> function logic through typing <code>?downloadHandler</code> in the Console and check with the example below.</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Show Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Add the following to your UI</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DT output </span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">card</span>(</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_header</span>(<span class="st">"Summary Table"</span>), <span class="co"># card header</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_body</span>(</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">downloadButton</span>(<span class="st">"download_summary"</span>, <span class="st">"Download CSV"</span>), <span class="co"># download button</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">DTOutput</span>(<span class="st">"summary_data"</span>) <span class="co"># DT output</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>        ),  </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">card_footer</span>(<span class="st">"Aggregated Annual Values per Province"</span>) <span class="co"># card footer</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And the following to the server:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-Code for handling data downloads--------------------------------------------------------------</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a reactive data frame for the summary table to pull data from same logic as in the</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data rendering code</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>summary_table_data <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  app_data <span class="sc">|&gt;</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(var_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"malaria_cases"</span>, <span class="st">"malaria_tests"</span>, <span class="st">"malaria_cases_per_1000"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> var_name, <span class="at">values_from =</span> value) <span class="sc">|&gt;</span> </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(organisation_unit) <span class="sc">|&gt;</span> </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">tpr =</span> <span class="fu">round</span>((malaria_cases <span class="sc">/</span> malaria_tests) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_cases =</span> <span class="fu">sum</span>(malaria_cases, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_tests =</span> <span class="fu">sum</span>(malaria_tests, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_tpr =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tpr, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_inc =</span> <span class="fu">round</span>(<span class="fu">mean</span>(malaria_cases_per_1000, <span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">1</span>), </span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">reporting_months_cases =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(malaria_cases)),</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">reporting_months_tests =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(malaria_tests))</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">Province =</span> organisation_unit,</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Cases</span><span class="st">`</span> <span class="ot">=</span> total_cases,</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Total Tests</span><span class="st">`</span> <span class="ot">=</span> total_tests,</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Average TPR (%)</span><span class="st">`</span> <span class="ot">=</span> avg_tpr,</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Avg Incidence</span><span class="st">`</span> <span class="ot">=</span> avg_inc,</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Case Reporting Months</span><span class="st">`</span> <span class="ot">=</span> reporting_months_cases,</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Test Reporting Months</span><span class="st">`</span> <span class="ot">=</span> reporting_months_tests</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable file download </span></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>download_summary <span class="ot">&lt;-</span> <span class="fu">downloadHandler</span>(</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the filename for the downloaded file</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="cf">function</span>() { <span class="fu">paste0</span>(<span class="st">"summary_data_"</span>, <span class="fu">Sys.Date</span>(), <span class="st">".csv"</span>) }, <span class="co"># This will create a file name with the current date</span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the content of the file </span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">content =</span> <span class="cf">function</span>(file) {</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.csv</span>(<span class="fu">summary_table_data</span>(), file, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="co"># Write the summary table data to a CSV file</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/download-handler.PNG" class="img-fluid"></p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="wrapping-up" class="level1">
<h1>Wrapping Up</h1>
<p>By the end of this tutorial you have successfully built a fully functional malaria data dashboard in Shiny that allows you to:</p>
<ul>
<li><p>Select a Province and filter data interactively</p></li>
<li><p>Compute derived indicators (such as Test Positivity Rate) directly within the app</p></li>
<li><p>Display multiple types of outputs:</p>
<ul>
<li><p>Value boxes for summary statistics</p></li>
<li><p>Time series plots</p></li>
<li><p>Maps using Leaflet</p></li>
<li><p>Summary tables with download options</p></li>
</ul></li>
<li><p>Apply conditional UI elements that only appear when appropriate inputs are selected</p></li>
<li><p>Style your app using <code>bslib</code> themes and branding elements such as logos, custom colors, and light/dark mode</p></li>
<li><p>Build dynamic layouts using <code>layout_sidebar()</code>, <code>cards()</code>, <code>value_box()</code>, <code>layout_columns()</code>, and <code>renderUI()</code></p></li>
<li><p>Control user experience through validation messages, prompts, and clean error handling</p></li>
<li><p>Export data using <code>downloadHandler()</code></p></li>
</ul>
<p>Throughout this process you have seen how Shiny allows you to link user inputs to real-time updates in your outputs, building fully reactive dashboards that allow end-users to explore and analyse data without needing to modify code directly.</p>
<p>The skills you have developed through this workshop form the foundation for building interactive data dashboards that can support decision-making across a range of public health, program management, or analytic tasks.</p>
</section>
<section id="next-steps-and-extensions" class="level1">
<h1>Next Steps and Extensions</h1>
<p>While we have covered a broad range of features, this only scratches the surface of what you can build with Shiny. Below are some suggested areas to explore next as you continue developing your Shiny skills.</p>
<section id="expanding-functionality" class="level2">
<h2 class="anchored" data-anchor-id="expanding-functionality">Expanding Functionality</h2>
<ul>
<li><p>Add additional filters such as date ranges or multiple administrative levels</p></li>
<li><p>Include new calculated indicators directly within the dashboard</p></li>
<li><p>Build more complex plots, for example:</p>
<ul>
<li><p>Adding trendlines or smoothing</p></li>
<li><p>Faceting across multiple provinces</p></li>
<li><p>Allowing users to interactively select multiple indicators for comparison</p></li>
</ul></li>
<li><p>Allow users to upload their own datasets into the dashboard directly</p></li>
<li><p>Build drill-down functionality to explore district- or facility-level data</p></li>
</ul>
</section>
<section id="organizing-and-scaling-your-code" class="level2">
<h2 class="anchored" data-anchor-id="organizing-and-scaling-your-code">Organizing and Scaling Your Code</h2>
<p>As dashboards become more complex, managing code in a single app file can become difficult. You may want to:</p>
<ul>
<li><p>Split your code into multiple files, separating UI, server, and helper functions</p></li>
<li><p>Use modular design with <code>callModule()</code> or <code>moduleServer()</code> to create reusable components</p></li>
<li><p>Build centralized helper functions (e.g., <code>helpers.R</code>) for repeated tasks such as data filtering or value box creation</p></li>
</ul>
<p>This makes your code easier to maintain and scale over time.</p>
</section>
<section id="deployment-and-sharing" class="level2">
<h2 class="anchored" data-anchor-id="deployment-and-sharing">Deployment and Sharing</h2>
<p>There are multiple options for sharing Shiny dashboards:</p>
<ul>
<li><p>Running locally for personal or internal use</p></li>
<li><p>Publishing to cloud services such as <a href="https://www.shinyapps.io/">shinyapps.io</a> (free options)</p></li>
<li><p>Deploying on enterprise platforms such as Posit Connect ($$)</p></li>
<li><p>Hosting internally on government or institutional servers</p></li>
</ul>
<p>When deploying dashboards, consider whether your data includes any sensitive or confidential information. Secure hosting, access controls, and user authentication may be required depending on your intended audience.</p>
</section>
<section id="styling-and-user-experience" class="level2">
<h2 class="anchored" data-anchor-id="styling-and-user-experience">Styling and User Experience</h2>
<p>In addition to the core functionality, improving the design and appearance of your dashboard can make it easier to use:</p>
<ul>
<li><p>Customize your <code>bslib</code> themes to align with institutional branding</p></li>
<li><p>Provide users with contextual help such as pop-up modals or collapsible panels to explain indicators or methods</p></li>
<li><p>Use dynamic tooltips, colour schemes, or alert messages to highlight important information</p></li>
</ul>
</section>
<section id="useful-resources-for-further-learning" class="level2">
<h2 class="anchored" data-anchor-id="useful-resources-for-further-learning">Useful Resources for Further Learning</h2>
<ul>
<li><p><a href="https://shiny.posit.co/">Shiny Official Documentation</a></p></li>
<li><p><a href="https://mastering-shiny.org/">Mastering Shiny by Hadley Wickham</a> (free online book)</p></li>
<li><p><a href="https://rstudio.github.io/bslib/">bslib Documentation</a> for theming</p></li>
<li><p><a href="https://shiny.posit.co/r/gallery/">Shiny Gallery</a>Examples for code samples</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/PATH-Global-Health\.github\.io\/ammnet-training-20215\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Ammnet Senegal 2025 Workshop | PATH</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>